


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mmseg.apis &mdash; RSI-Segmentation 0.24.1 documentation</title>
  

  <link rel="shortcut icon" href="_static/images/favicon.ico" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/readthedocs.css" type="text/css" />
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <!-- Google Analytics -->
  <script type="text/javascript">
    var collapsedSections = [];
  </script>
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://rsi-segmentation.readthedocs.io/en/latest/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/EarthNets/RSI-Segmentation/blob/main/demo/rsi_segmentation_tutorial.ipynb" target="_blank">Tutorial</a>
          </li>
          <li>
            <a href="https://github.com/EarthNets/RSI-Segmentation" target="_blank">GitHub</a>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                About
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/open-mmlab/mmcv" target="_blank">
                  <span class="dropdown-title">MMCV </span>
                  <p>Foundational library for computer vision</p>
                </a>
              </div>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                EarthNets
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/Dataset4EO" target="_blank">
                  <span class="dropdown-title">Dataset4EO </span>
                  <p>Re-organize remote sensing datasets.</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/RSI-Classification" target="_blank">
                  <span class="dropdown-title">RSI-Classification </span>
                  <p>Image/scene classification for RS images.</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/RSI-Segmentation" target="_blank">
                  <span class="dropdown-title">RSI-Segmentation </span>
                  <p>Pixel-wise semantic segmentation for RS images.</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/RSI-Detection" target="_blank">
                  <span class="dropdown-title">RSI-Detection </span>
                  <p>Object detection for RS images.</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/RSI-ChangeDetection" target="_blank">
                  <span class="dropdown-title">RSI-ChangeDetection </span>
                  <p>Change detection for RS images.</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/EarthNets/RSI-SelfSupervised" target="_blank">
                  <span class="dropdown-title">RSI-SelfSupervised </span>
                  <p>Self-supervised learning for RS images.</p>
                </a>
              </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started.html#verification">Verification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dataset Preparation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataset_prepare.html">Prepare datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Zoo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">Benchmark and Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelzoo_statistics.html">Model Zoo Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick Run</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="train.html">Train a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference with pretrained models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/config.html">Tutorial 1: Learn about Configs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/customize_datasets.html">Tutorial 2: Customize Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/data_pipeline.html">Tutorial 3: Customize Data Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/customize_models.html">Tutorial 4: Customize Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/training_tricks.html">Tutorial 5: Training Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/customize_runtime.html">Tutorial 6: Customize Runtime Settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Useful Tools and Scripts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="useful_tools.html">Useful tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="useful_tools.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="useful_tools.html#model-serving">Model Serving</a></li>
<li class="toctree-l1"><a class="reference internal" href="useful_tools.html#confusion-matrix">Confusion Matrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
            Docs
        </a> &gt;
      </li>

        
      <li>mmseg.apis</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
  <section id="module-mmseg.apis">
<span id="mmseg-apis"></span><h1>mmseg.apis<a class="headerlink" href="#module-mmseg.apis" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.get_root_logger">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">get_root_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/utils/logger.html#get_root_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.get_root_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the root logger.</p>
<p>The logger will be initialized if it has not been initialized. By default a
StreamHandler will be added. If <cite>log_file</cite> is specified, a FileHandler will
also be added. The name of the root logger is the top-level package name,
e.g., “mmseg”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_file</strong> (<em>str</em><em> | </em><em>None</em>) – The log filename. If specified, a FileHandler
will be added to the root logger.</p></li>
<li><p><strong>log_level</strong> (<em>int</em>) – The root logger level. Note that only the process of
rank 0 is affected, while other processes will set the level to
“Error” and be silent most of the time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The root logger.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.inference_segmentor">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">inference_segmentor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/inference.html#inference_segmentor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.inference_segmentor" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference image(s) with the segmentor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – The loaded segmentor.</p></li>
<li><p><strong>imgs</strong> (<em>str/ndarray</em><em> or </em><em>list</em><em>[</em><em>str/ndarray</em><em>]</em>) – Either image files or loaded
images.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The segmentation result.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list[Tensor])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.init_segmentor">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">init_segmentor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda:0'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/inference.html#init_segmentor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.init_segmentor" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a segmentor from config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (str or <code class="xref py py-obj docutils literal notranslate"><span class="pre">mmcv.Config</span></code>) – Config file path or the config
object.</p></li>
<li><p><strong>checkpoint</strong> (<em>str</em><em>, </em><em>optional</em>) – Checkpoint path. If left as None, the model
will not load any weights.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – 0’.
Use ‘cpu’ for loading model on CPU.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The constructed segmentor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.multi_gpu_test">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">multi_gpu_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmpdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_collect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efficient_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/test.html#multi_gpu_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.multi_gpu_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test model with multiple gpus.</p>
<p>This method tests model with multiple gpus and collects the results
under two different modes: gpu and cpu modes. By setting ‘gpu_collect=True’
it encodes results to gpu tensors and use gpu communication for results
collection. On cpu mode it saves the results on different gpus to ‘tmpdir’
and collects them by the rank 0 worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – Model to be tested.</p></li>
<li><p><strong>data_loader</strong> (<em>utils.data.Dataloader</em>) – Pytorch data loader.</p></li>
<li><p><strong>tmpdir</strong> (<em>str</em>) – Path of directory to save the temporary results from
different gpus under cpu mode.</p></li>
<li><p><strong>gpu_collect</strong> (<em>bool</em>) – Option to use either gpu or cpu to collect results.</p></li>
<li><p><strong>efficient_test</strong> (<em>bool</em>) – Whether save the results as local numpy files to
save CPU memory during evaluation. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The prediction results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.set_random_seed">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">set_random_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/train.html#set_random_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.set_random_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random seed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed to be used.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Whether to set the deterministic option for
CUDNN backend, i.e., set <cite>torch.backends.cudnn.deterministic</cite>
to True and <cite>torch.backends.cudnn.benchmark</cite> to False.
Default: False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.show_result_pyplot">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">show_result_pyplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/inference.html#show_result_pyplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.show_result_pyplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the segmentation results on the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – The loaded segmentor.</p></li>
<li><p><strong>img</strong> (<em>str</em><em> or </em><em>np.ndarray</em>) – Image filename or loaded image.</p></li>
<li><p><strong>result</strong> (<em>list</em>) – The segmentation result.</p></li>
<li><p><strong>palette</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – The palette of segmentation
map. If None is given, random palette will be generated.
Default: None</p></li>
<li><p><strong>fig_size</strong> (<em>tuple</em>) – Figure size of the pyplot figure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.single_gpu_test">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">single_gpu_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efficient_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/test.html#single_gpu_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.single_gpu_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test with single GPU.
:returns: The prediction results.
:rtype: list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.apis.train_segmentor">
<span class="sig-prename descclassname"><span class="pre">mmseg.apis.</span></span><span class="sig-name descname"><span class="pre">train_segmentor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/apis/train.html#train_segmentor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.apis.train_segmentor" title="Permalink to this definition">¶</a></dt>
<dd><p>Launch segmentor training.</p>
</dd></dl>

</section>
<section id="mmseg-core">
<h1>mmseg.core<a class="headerlink" href="#mmseg-core" title="Permalink to this heading">¶</a></h1>
<section id="module-mmseg.core.seg">
<span id="seg"></span><h2>seg<a class="headerlink" href="#module-mmseg.core.seg" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.core.seg.BasePixelSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.core.seg.</span></span><span class="sig-name descname"><span class="pre">BasePixelSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/seg/sampler/base_pixel_sampler.html#BasePixelSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.seg.BasePixelSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class of pixel sampler.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.seg.BasePixelSampler.sample">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/seg/sampler/base_pixel_sampler.html#BasePixelSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.seg.BasePixelSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Placeholder for sample function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.core.seg.OHEMPixelSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.core.seg.</span></span><span class="sig-name descname"><span class="pre">OHEMPixelSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_kept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/seg/sampler/ohem_pixel_sampler.html#OHEMPixelSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.seg.OHEMPixelSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Online Hard Example Mining Sampler for segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> (<em>nn.Module</em>) – The context of sampler, subclass of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseDecodeHead</span></code>.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for hard example selection.
Below which, are prediction with low confidence. If not
specified, the hard examples will be pixels of top <code class="docutils literal notranslate"><span class="pre">min_kept</span></code>
loss. Default: None.</p></li>
<li><p><strong>min_kept</strong> (<em>int</em><em>, </em><em>optional</em>) – The minimum number of predictions to keep.
Default: 100000.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.seg.OHEMPixelSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/seg/sampler/ohem_pixel_sampler.html#OHEMPixelSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.seg.OHEMPixelSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample pixels that have high loss or with low prediction confidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_logit</strong> (<em>torch.Tensor</em>) – segmentation logits, shape (N, C, H, W)</p></li>
<li><p><strong>seg_label</strong> (<em>torch.Tensor</em>) – segmentation label, shape (N, 1, H, W)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>segmentation weight, shape (N, H, W)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.seg.build_pixel_sampler">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.seg.</span></span><span class="sig-name descname"><span class="pre">build_pixel_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">default_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/seg/builder.html#build_pixel_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.seg.build_pixel_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Build pixel sampler for segmentation map.</p>
</dd></dl>

</section>
<section id="module-mmseg.core.evaluation">
<span id="evaluation"></span><h2>evaluation<a class="headerlink" href="#module-mmseg.core.evaluation" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">DistEvalHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_collect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">eval_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#DistEvalHook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Distributed evaluation hook.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.dataloader">
<span class="sig-name descname"><span class="pre">dataloader</span></span><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>A PyTorch dataloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.interval">
<span class="sig-name descname"><span class="pre">interval</span></span><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluation interval (by epochs). Default: 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.tmpdir">
<span class="sig-name descname"><span class="pre">tmpdir</span></span><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.tmpdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporary directory to save the results of all
processes. Default: None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.gpu_collect">
<span class="sig-name descname"><span class="pre">gpu_collect</span></span><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.gpu_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use gpu or cpu to collect results.
Default: False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.after_train_epoch">
<span class="sig-name descname"><span class="pre">after_train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#DistEvalHook.after_train_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.after_train_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>After train epoch hook.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.evaluation.DistEvalHook.after_train_iter">
<span class="sig-name descname"><span class="pre">after_train_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#DistEvalHook.after_train_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.DistEvalHook.after_train_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>After train epoch hook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">EvalHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">eval_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#EvalHook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.EvalHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluation hook.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook.dataloader">
<span class="sig-name descname"><span class="pre">dataloader</span></span><a class="headerlink" href="#mmseg.core.evaluation.EvalHook.dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>A PyTorch dataloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook.interval">
<span class="sig-name descname"><span class="pre">interval</span></span><a class="headerlink" href="#mmseg.core.evaluation.EvalHook.interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluation interval (by epochs). Default: 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook.after_train_epoch">
<span class="sig-name descname"><span class="pre">after_train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#EvalHook.after_train_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.EvalHook.after_train_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>After train epoch hook.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook.after_train_iter">
<span class="sig-name descname"><span class="pre">after_train_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#EvalHook.after_train_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.EvalHook.after_train_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>After train epoch hook.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.core.evaluation.EvalHook.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/eval_hooks.html#EvalHook.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.EvalHook.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Call evaluate function of dataset.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.evaluation.eval_metrics">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">eval_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_seg_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['mIoU']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/metrics.html#eval_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.eval_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate evaluation metrics
:param results: List of prediction segmentation maps.
:type results: list[ndarray]
:param gt_seg_maps: list of ground truth segmentation maps.
:type gt_seg_maps: list[ndarray]
:param num_classes: Number of categories.
:type num_classes: int
:param ignore_index: Index that will be ignored in evaluation.
:type ignore_index: int
:param metrics: Metrics to be evaluated, ‘mIoU’ and ‘mDice’.
:type metrics: list[str] | str
:param nan_to_num: If specified, NaN values will be replaced</p>
<blockquote>
<div><p>by the numbers defined by the user. Default: None.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_map</strong> (<em>dict</em>) – Mapping old labels to new labels. Default: dict().</p></li>
<li><p><strong>reduce_zero_label</strong> – Wether ignore zero label. Default: False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.evaluation.get_classes">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">get_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/class_names.html#get_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.get_classes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get class names of a dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.evaluation.get_palette">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">get_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/class_names.html#get_palette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.get_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Get class palette (RGB) of a dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.evaluation.mean_dice">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">mean_dice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_seg_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/metrics.html#mean_dice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.mean_dice" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Mean Dice (mDice)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em><em>[</em><em>ndarray</em><em>]</em>) – List of prediction segmentation maps.</p></li>
<li><p><strong>gt_seg_maps</strong> (<em>list</em><em>[</em><em>ndarray</em><em>]</em>) – list of ground truth segmentation maps.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of categories.</p></li>
<li><p><strong>ignore_index</strong> (<em>int</em>) – Index that will be ignored in evaluation.</p></li>
<li><p><strong>nan_to_num</strong> (<em>int</em><em>, </em><em>optional</em>) – If specified, NaN values will be replaced
by the numbers defined by the user. Default: None.</p></li>
<li><p><strong>label_map</strong> (<em>dict</em>) – Mapping old labels to new labels. Default: dict().</p></li>
<li><p><strong>reduce_zero_label</strong> – Wether ignore zero label. Default: False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.evaluation.mean_iou">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.evaluation.</span></span><span class="sig-name descname"><span class="pre">mean_iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_seg_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/evaluation/metrics.html#mean_iou"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.evaluation.mean_iou" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Mean Intersection and Union (mIoU)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em><em>[</em><em>ndarray</em><em>]</em>) – List of prediction segmentation maps.</p></li>
<li><p><strong>gt_seg_maps</strong> (<em>list</em><em>[</em><em>ndarray</em><em>]</em>) – list of ground truth segmentation maps.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of categories.</p></li>
<li><p><strong>ignore_index</strong> (<em>int</em>) – Index that will be ignored in evaluation.</p></li>
<li><p><strong>nan_to_num</strong> (<em>int</em><em>, </em><em>optional</em>) – If specified, NaN values will be replaced
by the numbers defined by the user. Default: None.</p></li>
<li><p><strong>label_map</strong> (<em>dict</em>) – Mapping old labels to new labels. Default: dict().</p></li>
<li><p><strong>reduce_zero_label</strong> – Wether ignore zero label. Default: False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mmseg.core.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-mmseg.core.utils" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mmseg.core.utils.add_prefix">
<span class="sig-prename descclassname"><span class="pre">mmseg.core.utils.</span></span><span class="sig-name descname"><span class="pre">add_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/core/utils/misc.html#add_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.core.utils.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add prefix for dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>dict</em>) – The input dict with str keys.</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – The prefix to add.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dict with keys updated with <code class="docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="mmseg-datasets">
<h1>mmseg.datasets<a class="headerlink" href="#mmseg-datasets" title="Permalink to this heading">¶</a></h1>
<section id="module-mmseg.datasets">
<span id="datasets"></span><h2>datasets<a class="headerlink" href="#module-mmseg.datasets" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.ADE20KDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">ADE20KDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/ade.html#ADE20KDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.ADE20KDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>ADE20K dataset.</p>
<p>In segmentation map annotation for ADE20K, 0 stands for background, which
is not included in 150 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to True.
The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.jpg’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.ChaseDB1Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">ChaseDB1Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/chase_db1.html#ChaseDB1Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.ChaseDB1Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Chase_db1 dataset.</p>
<p>In segmentation map annotation for Chase_db1, 0 stands for background,
which is included in 2 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to False.
The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.png’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘_1stHO.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.CityscapesDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">CityscapesDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/cityscapes.html#CityscapesDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CityscapesDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Cityscapes dataset.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘_leftImg8bit.png’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is
fixed to ‘_gtFine_labelTrainIds.png’ for Cityscapes dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CityscapesDataset.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mIoU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgfile_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efficient_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/cityscapes.html#CityscapesDataset.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CityscapesDataset.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluation in Cityscapes/default protocol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em>) – Testing results of the dataset.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Metrics to be evaluated.</p></li>
<li><p><strong>logger</strong> (<em>logging.Logger</em><em> | </em><em>None</em><em> | </em><em>str</em>) – Logger used for printing
related information during evaluation. Default: None.</p></li>
<li><p><strong>imgfile_prefix</strong> (<em>str</em><em> | </em><em>None</em>) – The prefix of output image file,
for cityscapes evaluation only. It includes the file path and
the prefix of filename, e.g., “a/b/prefix”.
If results are evaluated with cityscapes protocol, it would be
the prefix of output png files. The output files would be
png images under folder “a/b/prefix/xxx.png”, where “xxx” is
the image name of cityscapes. If not specified, a temp file
will be created for evaluation.
Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cityscapes/default metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CityscapesDataset.format_results">
<span class="sig-name descname"><span class="pre">format_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgfile_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_label_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/cityscapes.html#CityscapesDataset.format_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CityscapesDataset.format_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the results into dir (standard format for Cityscapes
evaluation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em>) – Testing results of the dataset.</p></li>
<li><p><strong>imgfile_prefix</strong> (<em>str</em><em> | </em><em>None</em>) – The prefix of images files. It
includes the file path and the prefix of filename, e.g.,
“a/b/prefix”. If not specified, a temp file will be created.
Default: None.</p></li>
<li><p><strong>to_label_id</strong> (<em>bool</em>) – whether convert output to label_id for
submission. Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(result_files, tmp_dir), result_files is a list containing</dt><dd><p>the image paths, tmp_dir is the temporal directory created
for saving json/png files when img_prefix is not specified.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CityscapesDataset.results2img">
<span class="sig-name descname"><span class="pre">results2img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgfile_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_label_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/cityscapes.html#CityscapesDataset.results2img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CityscapesDataset.results2img" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the segmentation results to images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em><em>[</em><em>list</em><em> | </em><em>tuple</em><em> | </em><em>ndarray</em><em>]</em>) – Testing results of the
dataset.</p></li>
<li><p><strong>imgfile_prefix</strong> (<em>str</em>) – The filename prefix of the png files.
If the prefix is “somepath/xxx”,
the png files will be named “somepath/xxx.png”.</p></li>
<li><p><strong>to_label_id</strong> (<em>bool</em>) – whether convert output to label_id for
submission</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str]: result txt files which contains corresponding
semantic segmentation images.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.ConcatDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">ConcatDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/dataset_wrappers.html#ConcatDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.ConcatDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper of concatenated dataset.</p>
<p>Same as <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.dataset.ConcatDataset</span></code>, but
concat the group flag for image aspect ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>datasets</strong> (list[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dataset</span></code>]) – A list of datasets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">CustomDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.jpg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_map_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom dataset for semantic segmentation. An example of file structure
is as followed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>├── data
│   ├── my_dataset
│   │   ├── img_dir
│   │   │   ├── train
│   │   │   │   ├── xxx{img_suffix}
│   │   │   │   ├── yyy{img_suffix}
│   │   │   │   ├── zzz{img_suffix}
│   │   │   ├── val
│   │   ├── ann_dir
│   │   │   ├── train
│   │   │   │   ├── xxx{seg_map_suffix}
│   │   │   │   ├── yyy{seg_map_suffix}
│   │   │   │   ├── zzz{seg_map_suffix}
│   │   │   ├── val
</pre></div>
</div>
<p>The img/gt_semantic_seg pair of CustomDataset should be of the same
except suffix. A valid img/gt_semantic_seg filename pair should be like
<code class="docutils literal notranslate"><span class="pre">xxx{img_suffix}</span></code> and <code class="docutils literal notranslate"><span class="pre">xxx{seg_map_suffix}</span></code> (extension is also included
in the suffix). If split is given, then <code class="docutils literal notranslate"><span class="pre">xxx</span></code> is specified in txt file.
Otherwise, all files in <code class="docutils literal notranslate"><span class="pre">img_dir/``and</span> <span class="pre">``ann_dir</span></code> will be loaded.
Please refer to <code class="docutils literal notranslate"><span class="pre">docs/tutorials/new_dataset.md</span></code> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipeline</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – Processing pipeline</p></li>
<li><p><strong>img_dir</strong> (<em>str</em>) – Path to image directory</p></li>
<li><p><strong>img_suffix</strong> (<em>str</em>) – Suffix of images. Default: ‘.jpg’</p></li>
<li><p><strong>ann_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to annotation directory. Default: None</p></li>
<li><p><strong>seg_map_suffix</strong> (<em>str</em>) – Suffix of segmentation maps. Default: ‘.png’</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Split txt file. If split is specified, only
file with suffix in the splits will be loaded. Otherwise, all
images in img_dir/ann_dir will be loaded. Default: None</p></li>
<li><p><strong>data_root</strong> (<em>str</em><em>, </em><em>optional</em>) – Data root for img_dir/ann_dir. Default:
None.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>) – If test_mode=True, gt wouldn’t be loaded.</p></li>
<li><p><strong>ignore_index</strong> (<em>int</em>) – The label index to be ignored. Default: 255</p></li>
<li><p><strong>reduce_zero_label</strong> (<em>bool</em>) – Whether to mark label zero as ignored.
Default: False</p></li>
<li><p><strong>classes</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Specify classes to load.
If is None, <code class="docutils literal notranslate"><span class="pre">cls.CLASSES</span></code> will be used. Default: None.</p></li>
<li><p><strong>palette</strong> (<em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>int</em><em>]</em><em>]</em><em>] </em><em>| </em><em>np.ndarray</em><em> | </em><em>None</em>) – The palette of segmentation map. If None is given, and
self.PALETTE is None, random palette will be generated.
Default: None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mIoU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efficient_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list</em>) – Testing results of the dataset.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Metrics to be evaluated. ‘mIoU’ and
‘mDice’ are supported.</p></li>
<li><p><strong>logger</strong> (<em>logging.Logger</em><em> | </em><em>None</em><em> | </em><em>str</em>) – Logger used for printing
related information during evaluation. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Default metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.format_results">
<span class="sig-name descname"><span class="pre">format_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.format_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.format_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Place holder to format result to dataset specific output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.get_ann_info">
<span class="sig-name descname"><span class="pre">get_ann_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.get_ann_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.get_ann_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get annotation by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – Index of data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Annotation info of specified index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.get_classes_and_palette">
<span class="sig-name descname"><span class="pre">get_classes_and_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.get_classes_and_palette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.get_classes_and_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Get class names of current dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>str</em><em> | </em><em>None</em>) – If classes is None, use
default CLASSES defined by builtin dataset. If classes is a
string, take it as a file name. The file contains the name of
classes where each line contains one class name. If classes is
a tuple or list, override the CLASSES defined by the dataset.</p></li>
<li><p><strong>palette</strong> (<em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>int</em><em>]</em><em>]</em><em>] </em><em>| </em><em>np.ndarray</em><em> | </em><em>None</em>) – The palette of segmentation map. If None is given, random
palette will be generated. Default: None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.get_gt_seg_maps">
<span class="sig-name descname"><span class="pre">get_gt_seg_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">efficient_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.get_gt_seg_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.get_gt_seg_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Get ground truth segmentation maps for evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.load_annotations">
<span class="sig-name descname"><span class="pre">load_annotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_map_suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.load_annotations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.load_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotation from directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_dir</strong> (<em>str</em>) – Path to image directory</p></li>
<li><p><strong>img_suffix</strong> (<em>str</em>) – Suffix of images.</p></li>
<li><p><strong>ann_dir</strong> (<em>str</em><em>|</em><em>None</em>) – Path to annotation directory.</p></li>
<li><p><strong>seg_map_suffix</strong> (<em>str</em><em>|</em><em>None</em>) – Suffix of segmentation maps.</p></li>
<li><p><strong>split</strong> (<em>str</em><em>|</em><em>None</em>) – Split txt file. If split is specified, only file
with suffix in the splits will be loaded. Otherwise, all images
in img_dir/ann_dir will be loaded. Default: None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All image info of dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.pre_pipeline">
<span class="sig-name descname"><span class="pre">pre_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.pre_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.pre_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare results dict for pipeline.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.prepare_test_img">
<span class="sig-name descname"><span class="pre">prepare_test_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.prepare_test_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.prepare_test_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Get testing data after pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – Index of data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Testing data after pipeline with new keys intorduced by</dt><dd><p>piepline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.CustomDataset.prepare_train_img">
<span class="sig-name descname"><span class="pre">prepare_train_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/custom.html#CustomDataset.prepare_train_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.CustomDataset.prepare_train_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Get training data and annotations after pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – Index of data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Training data and annotation after pipeline with new keys</dt><dd><p>introduced by pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.DRIVEDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">DRIVEDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/drive.html#DRIVEDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.DRIVEDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>DRIVE dataset.</p>
<p>In segmentation map annotation for DRIVE, 0 stands for background, which is
included in 2 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to False. The
<code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.png’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘_manual1.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.FlowDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">FlowDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args=&lt;class</span> <span class="pre">'mmseg.datasets.flow_dataset.args'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=RandomState(MT19937)</span> <span class="pre">at</span> <span class="pre">0x7F8C2D715A40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/flow_dataset.html#FlowDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.FlowDataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.GTADataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">GTADataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/gta_dataset.html#GTADataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.GTADataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Height dataset.</p>
<p>In segmentation map annotation for ADE20K, 0 stands for background, which
is not included in 150 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to True.
The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.jpg’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.HRFDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">HRFDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/hrf.html#HRFDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.HRFDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>HRF dataset.</p>
<p>In segmentation map annotation for HRF, 0 stands for background, which is
included in 2 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to False. The
<code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.png’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.HeightDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">HeightDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/height.html#HeightDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.HeightDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Height dataset.</p>
<p>In segmentation map annotation for ADE20K, 0 stands for background, which
is not included in 150 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to True.
The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.jpg’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘.png’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.PascalContextDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">PascalContextDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pascal_context.html#PascalContextDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.PascalContextDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>PascalContext dataset.</p>
<p>In segmentation map annotation for PascalContext, 0 stands for background,
which is included in 60 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to
False. The <code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.jpg’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is
fixed to ‘.png’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>split</strong> (<em>str</em>) – Split txt file for PascalContext.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.PascalVOCDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">PascalVOCDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/voc.html#PascalVOCDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.PascalVOCDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Pascal VOC dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>split</strong> (<em>str</em>) – Split txt file for Pascal VOC.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.RepeatDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">RepeatDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/dataset_wrappers.html#RepeatDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.RepeatDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper of repeated dataset.</p>
<p>The length of repeated dataset will be <cite>times</cite> larger than the original
dataset. This is useful when the data loading time is long but the dataset
is small. Using RepeatDataset can reduce the data loading time between
epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dataset</span></code>) – The dataset to be repeated.</p></li>
<li><p><strong>times</strong> (<em>int</em>) – Repeat times.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.STAREDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">STAREDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/stare.html#STAREDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.STAREDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>STARE dataset.</p>
<p>In segmentation map annotation for STARE, 0 stands for background, which is
included in 2 categories. <code class="docutils literal notranslate"><span class="pre">reduce_zero_label</span></code> is fixed to False. The
<code class="docutils literal notranslate"><span class="pre">img_suffix</span></code> is fixed to ‘.png’ and <code class="docutils literal notranslate"><span class="pre">seg_map_suffix</span></code> is fixed to
‘.ah.png’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.datasets.build_dataloader">
<span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">build_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples_per_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers_per_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pin_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PoolDataLoader'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/builder.html#build_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.build_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Build PyTorch DataLoader.</p>
<p>In distributed training, each GPU/process has a dataloader.
In non-distributed training, there is only one dataloader for all GPUs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – A PyTorch dataset.</p></li>
<li><p><strong>samples_per_gpu</strong> (<em>int</em>) – Number of training samples on each GPU, i.e.,
batch size of each GPU.</p></li>
<li><p><strong>workers_per_gpu</strong> (<em>int</em>) – How many subprocesses to use for data loading
for each GPU.</p></li>
<li><p><strong>num_gpus</strong> (<em>int</em>) – Number of GPUs. Only used in non-distributed training.</p></li>
<li><p><strong>dist</strong> (<em>bool</em>) – Distributed training/test or not. Default: True.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – Whether to shuffle the data at every epoch.
Default: True.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em> | </em><em>None</em>) – Seed to be used. Default: None.</p></li>
<li><p><strong>drop_last</strong> (<em>bool</em>) – Whether to drop the last incomplete batch in epoch.
Default: False</p></li>
<li><p><strong>pin_memory</strong> (<em>bool</em>) – Whether to use pin_memory in DataLoader.
Default: True</p></li>
<li><p><strong>dataloader_type</strong> (<em>str</em>) – Type of dataloader. Default: ‘PoolDataLoader’</p></li>
<li><p><strong>kwargs</strong> – any keyword argument to be used to initialize DataLoader</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A PyTorch dataloader.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.datasets.build_dataset">
<span class="sig-prename descclassname"><span class="pre">mmseg.datasets.</span></span><span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/builder.html#build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.build_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Build datasets.</p>
</dd></dl>

</section>
<section id="module-mmseg.datasets.pipelines">
<span id="pipelines"></span><h2>pipelines<a class="headerlink" href="#module-mmseg.datasets.pipelines" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.AdjustGamma">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">AdjustGamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#AdjustGamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.AdjustGamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Using gamma correction to process the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gamma</strong> (<em>float</em><em> or </em><em>int</em>) – Gamma value used in gamma correction.
Default: 1.0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.CLAHE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">CLAHE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clip_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#CLAHE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.CLAHE" title="Permalink to this definition">¶</a></dt>
<dd><p>Use CLAHE method to process the image.</p>
<p>See <cite>ZUIDERVELD,K. Contrast Limited Adaptive Histogram Equalization[J].
Graphics Gems, 1994:474-485.</cite> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clip_limit</strong> (<em>float</em>) – Threshold for contrast limiting. Default: 40.0.</p></li>
<li><p><strong>tile_grid_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Size of grid for histogram equalization.
Input image will be divided into equally sized rectangular tiles.
It defines the number of tiles in row and column. Default: (8, 8).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Collect">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('filename',</span> <span class="pre">'ori_filename',</span> <span class="pre">'ori_shape',</span> <span class="pre">'img_shape',</span> <span class="pre">'pad_shape',</span> <span class="pre">'scale_factor',</span> <span class="pre">'flip',</span> <span class="pre">'flip_direction',</span> <span class="pre">'img_norm_cfg')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#Collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect data from the loader relevant to the specific task.</p>
<p>This is usually the last stage of the data loader pipeline. Typically keys
is set to some subset of “img”, “gt_semantic_seg”.</p>
<p>The “img_meta” item is always populated.  The contents of the “img_meta”
dictionary depends on “meta_keys”. By default this includes:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>“img_shape”: shape of the image input to the network as a tuple</dt><dd><p>(h, w, c).  Note that images may be zero padded on the bottom/right
if the batch tensor is larger than this shape.</p>
</dd>
</dl>
</li>
<li><p>“scale_factor”: a float indicating the preprocessing scale</p></li>
<li><p>“flip”: a boolean indicating if image flip transform was used</p></li>
<li><p>“filename”: path to the image file</p></li>
<li><p>“ori_shape”: original shape of the image as a tuple (h, w, c)</p></li>
<li><p>“pad_shape”: image shape after padding</p></li>
<li><dl class="simple">
<dt>“img_norm_cfg”: a dict of normalization information:</dt><dd><ul>
<li><p>mean - per channel mean subtraction</p></li>
<li><p>std - per channel std divisor</p></li>
<li><p>to_rgb - bool indicating if bgr was converted to rgb</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Keys of results to be collected in <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>meta_keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Meta keys to be converted to
<code class="docutils literal notranslate"><span class="pre">mmcv.DataContainer</span></code> and collected in <code class="docutils literal notranslate"><span class="pre">data[img_metas]</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">('filename',</span> <span class="pre">'ori_filename',</span> <span class="pre">'ori_shape',</span> <span class="pre">'img_shape',</span>
<span class="pre">'pad_shape',</span> <span class="pre">'scale_factor',</span> <span class="pre">'flip',</span> <span class="pre">'flip_direction',</span>
<span class="pre">'img_norm_cfg')</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Compose">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transforms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/compose.html#Compose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Compose" title="Permalink to this definition">¶</a></dt>
<dd><p>Compose multiple transforms sequentially.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transforms</strong> (<em>Sequence</em><em>[</em><em>dict</em><em> | </em><em>callable</em><em>]</em>) – Sequence of transform object or
config dict to be composed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.ImageToTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">ImageToTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#ImageToTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.ImageToTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert image to <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code> by given keys.</p>
<p>The dimension order of input image is (H, W, C). The pipeline will convert
it to (C, H, W). If only 2 dimension (H, W) is given, the output would be
(1, H, W).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Key of images to be converted to Tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.LoadAnnotations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">LoadAnnotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_client_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'backend':</span> <span class="pre">'disk'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imdecode_backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pillow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/loading.html#LoadAnnotations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.LoadAnnotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotations for semantic segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduce_zero_label</strong> (<em>bool</em>) – Whether reduce all label value by 1.
Usually used for datasets where 0 is background label.
Default: False.</p></li>
<li><p><strong>file_client_args</strong> (<em>dict</em>) – Arguments to instantiate a FileClient.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">mmcv.fileio.FileClient</span></code> for details.
Defaults to <code class="docutils literal notranslate"><span class="pre">dict(backend='disk')</span></code>.</p></li>
<li><p><strong>imdecode_backend</strong> (<em>str</em>) – Backend for <code class="xref py py-func docutils literal notranslate"><span class="pre">mmcv.imdecode()</span></code>. Default:
‘pillow’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.LoadAnnotationsDepth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">LoadAnnotationsDepth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduce_zero_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_client_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'backend':</span> <span class="pre">'disk'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imdecode_backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pillow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/loading.html#LoadAnnotationsDepth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.LoadAnnotationsDepth" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotations for semantic segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduce_zero_label</strong> (<em>bool</em>) – Whether reduce all label value by 1.
Usually used for datasets where 0 is background label.
Default: False.</p></li>
<li><p><strong>file_client_args</strong> (<em>dict</em>) – Arguments to instantiate a FileClient.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">mmcv.fileio.FileClient</span></code> for details.
Defaults to <code class="docutils literal notranslate"><span class="pre">dict(backend='disk')</span></code>.</p></li>
<li><p><strong>imdecode_backend</strong> (<em>str</em>) – Backend for <code class="xref py py-func docutils literal notranslate"><span class="pre">mmcv.imdecode()</span></code>. Default:
‘pillow’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.LoadImageFromFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">LoadImageFromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_float32</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'color'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_client_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'backend':</span> <span class="pre">'disk'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imdecode_backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cv2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/loading.html#LoadImageFromFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.LoadImageFromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an image from file.</p>
<p>Required keys are “img_prefix” and “img_info” (a dict that must contain the
key “filename”). Added or updated keys are “filename”, “img”, “img_shape”,
“ori_shape” (same as <cite>img_shape</cite>), “pad_shape” (same as <cite>img_shape</cite>),
“scale_factor” (1.0) and “img_norm_cfg” (means=0 and stds=1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_float32</strong> (<em>bool</em>) – Whether to convert the loaded image to a float32
numpy array. If set to False, the loaded image is an uint8 array.
Defaults to False.</p></li>
<li><p><strong>color_type</strong> (<em>str</em>) – The flag argument for <code class="xref py py-func docutils literal notranslate"><span class="pre">mmcv.imfrombytes()</span></code>.
Defaults to ‘color’.</p></li>
<li><p><strong>file_client_args</strong> (<em>dict</em>) – Arguments to instantiate a FileClient.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">mmcv.fileio.FileClient</span></code> for details.
Defaults to <code class="docutils literal notranslate"><span class="pre">dict(backend='disk')</span></code>.</p></li>
<li><p><strong>imdecode_backend</strong> (<em>str</em>) – Backend for <code class="xref py py-func docutils literal notranslate"><span class="pre">mmcv.imdecode()</span></code>. Default:
‘cv2’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.MultiScaleFlipAug">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">MultiScaleFlipAug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transforms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'horizontal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/test_time_aug.html#MultiScaleFlipAug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.MultiScaleFlipAug" title="Permalink to this definition">¶</a></dt>
<dd><p>Test-time augmentation with multiple scales and flipping.</p>
<p>An example configuration is as followed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">img_scale</span><span class="o">=</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span>
<span class="n">img_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="n">transforms</span><span class="o">=</span><span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Resize&#39;</span><span class="p">,</span> <span class="n">keep_ratio</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;RandomFlip&#39;</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Normalize&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">img_norm_cfg</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Pad&#39;</span><span class="p">,</span> <span class="n">size_divisor</span><span class="o">=</span><span class="mi">32</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ImageToTensor&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Collect&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>After MultiScaleFLipAug with above configuration, the results are wrapped
into lists of the same length as followed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">img</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">img_shape</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">scale</span><span class="o">=</span><span class="p">[(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)]</span>
    <span class="n">flip</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transforms</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – Transforms to apply in each augmentation.</p></li>
<li><p><strong>img_scale</strong> (<em>None</em><em> | </em><em>tuple</em><em> | </em><em>list</em><em>[</em><em>tuple</em><em>]</em>) – Images scales for resizing.</p></li>
<li><p><strong>img_ratios</strong> (<em>float</em><em> | </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Image ratios for resizing</p></li>
<li><p><strong>flip</strong> (<em>bool</em>) – Whether apply flip augmentation. Default: False.</p></li>
<li><p><strong>flip_direction</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Flip augmentation directions,
options are “horizontal” and “vertical”. If flip_direction is list,
multiple flip augmentations will be applied.
It has no effect when flip == False. Default: “horizontal”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Normalize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the image.</p>
<p>Added key is “img_norm_cfg”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>sequence</em>) – Mean values of 3 channels.</p></li>
<li><p><strong>std</strong> (<em>sequence</em>) – Std values of 3 channels.</p></li>
<li><p><strong>to_rgb</strong> (<em>bool</em>) – Whether to convert the image from BGR to RGB,
default is true.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Pad">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_pad_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad the image &amp; mask.</p>
<p>There are two padding modes: (1) pad to a fixed size and (2) pad to the
minimum size that is divisible by some number.
Added keys are “pad_shape”, “pad_fixed_size”, “pad_size_divisor”,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Fixed padding size.</p></li>
<li><p><strong>size_divisor</strong> (<em>int</em><em>, </em><em>optional</em>) – The divisor of padded size.</p></li>
<li><p><strong>pad_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Padding value. Default: 0.</p></li>
<li><p><strong>seg_pad_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Padding value of segmentation map.
Default: 255.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">PhotoMetricDistortion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brightness_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saturation_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">18</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply photometric distortion to image sequentially, every transformation
is applied with a probability of 0.5. The position of random contrast is in
second or second to last.</p>
<ol class="arabic simple">
<li><p>random brightness</p></li>
<li><p>random contrast (mode 0)</p></li>
<li><p>convert color from BGR to HSV</p></li>
<li><p>random saturation</p></li>
<li><p>random hue</p></li>
<li><p>convert color from HSV to BGR</p></li>
<li><p>random contrast (mode 1)</p></li>
<li><p>randomly swap channels</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>brightness_delta</strong> (<em>int</em>) – delta of brightness.</p></li>
<li><p><strong>contrast_range</strong> (<em>tuple</em>) – range of contrast.</p></li>
<li><p><strong>saturation_range</strong> (<em>tuple</em>) – range of saturation.</p></li>
<li><p><strong>hue_delta</strong> (<em>int</em>) – delta of hue.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion.brightness">
<span class="sig-name descname"><span class="pre">brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion.brightness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion.brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Brightness distortion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion.contrast">
<span class="sig-name descname"><span class="pre">contrast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion.contrast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion.contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Contrast distortion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion.convert">
<span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion.convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiple with alpha and add beat with clip.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion.hue">
<span class="sig-name descname"><span class="pre">hue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion.hue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion.hue" title="Permalink to this definition">¶</a></dt>
<dd><p>Hue distortion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.PhotoMetricDistortion.saturation">
<span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#PhotoMetricDistortion.saturation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.PhotoMetricDistortion.saturation" title="Permalink to this definition">¶</a></dt>
<dd><p>Saturation distortion.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RGB2Gray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">RGB2Gray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.299,</span> <span class="pre">0.587,</span> <span class="pre">0.114)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RGB2Gray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RGB2Gray" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert RGB image to grayscale image.</p>
<p>This transform calculate the weighted mean of input image channels with
<code class="docutils literal notranslate"><span class="pre">weights</span></code> and then expand the channels to <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>. When
<code class="docutils literal notranslate"><span class="pre">out_channels</span></code> is None, the number of output channels is the same as
input channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_channels</strong> (<em>int</em>) – Expected number of output channels after
transforming. Default: None.</p></li>
<li><p><strong>weights</strong> (<em>tuple</em><em>[</em><em>float</em><em>]</em>) – The weights to calculate the weighted mean.
Default: (0.299, 0.587, 0.114).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RandomCrop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">RandomCrop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_max_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RandomCrop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RandomCrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Random crop the image &amp; seg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crop_size</strong> (<em>tuple</em>) – Expected size after cropping, (h, w).</p></li>
<li><p><strong>cat_max_ratio</strong> (<em>float</em>) – The maximum ratio that single category could
occupy.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RandomCrop.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RandomCrop.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RandomCrop.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop from <code class="docutils literal notranslate"><span class="pre">img</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RandomCrop.get_crop_bbox">
<span class="sig-name descname"><span class="pre">get_crop_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RandomCrop.get_crop_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RandomCrop.get_crop_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly get a crop bounding box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RandomFlip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">RandomFlip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'horizontal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RandomFlip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RandomFlip" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip the image &amp; seg.</p>
<p>If the input dict contains the key “flip”, then the flag will be used,
otherwise it will be randomly decided by a ratio specified in the init
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>float</em><em>, </em><em>optional</em>) – The flipping probability. Default: None.</p></li>
<li><p><strong>direction</strong> (<em>str</em><em>, </em><em>optional</em>) – The flipping direction. Options are
‘horizontal’ and ‘vertical’. Default: ‘horizontal’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.RandomRotate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">RandomRotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_pad_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#RandomRotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.RandomRotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the image &amp; seg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>float</em>) – The rotation probability.</p></li>
<li><p><strong>degree</strong> (<em>float</em><em>, </em><em>tuple</em><em>[</em><em>float</em><em>]</em>) – Range of degrees to select from. If
degree is a number instead of tuple like (min, max),
the range of degree will be (<code class="docutils literal notranslate"><span class="pre">-degree</span></code>, <code class="docutils literal notranslate"><span class="pre">+degree</span></code>)</p></li>
<li><p><strong>pad_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Padding value of image. Default: 0.</p></li>
<li><p><strong>seg_pad_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Padding value of segmentation map.
Default: 255.</p></li>
<li><p><strong>center</strong> (<em>tuple</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Center point (w, h) of the rotation in
the source image. If not specified, the center of the image will be
used. Default: None.</p></li>
<li><p><strong>auto_bound</strong> (<em>bool</em>) – Whether to adjust the image size to cover the whole
rotated image. Default: False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Rerange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Rerange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Rerange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Rerange" title="Permalink to this definition">¶</a></dt>
<dd><p>Rerange the image pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_value</strong> (<em>float</em><em> or </em><em>int</em>) – Minimum value of the reranged image.
Default: 0.</p></li>
<li><p><strong>max_value</strong> (<em>float</em><em> or </em><em>int</em>) – Maximum value of the reranged image.
Default: 255.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Resize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiscale_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'range'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize images &amp; seg.</p>
<p>This transform resizes the input image to some scale. If the input dict
contains the key “scale”, then the scale in the input dict is used,
otherwise the specified scale in the init method is used.</p>
<p><code class="docutils literal notranslate"><span class="pre">img_scale</span></code> can be Nong, a tuple (single-scale) or a list of tuple
(multi-scale). There are 4 multiscale modes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ratio_range</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>:</p></li>
</ul>
<ol class="arabic simple">
<li><dl class="simple">
<dt>When img_scale is None, img_scale is the shape of image in results</dt><dd><p>(img_scale = results[‘img’].shape[:2]) and the image is resized based
on the original size. (mode 1)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>When img_scale is a tuple (single-scale), randomly sample a ratio from</dt><dd><p>the ratio range and multiply it with the image scale. (mode 2)</p>
</dd>
</dl>
</li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ratio_range</span> <span class="pre">is</span> <span class="pre">None</span> <span class="pre">and</span> <span class="pre">multiscale_mode</span> <span class="pre">==</span> <span class="pre">&quot;range&quot;</span></code>: randomly sample a</p></li>
</ul>
<p>scale from the a range. (mode 3)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ratio_range</span> <span class="pre">is</span> <span class="pre">None</span> <span class="pre">and</span> <span class="pre">multiscale_mode</span> <span class="pre">==</span> <span class="pre">&quot;value&quot;</span></code>: randomly sample a</p></li>
</ul>
<p>scale from multiple scales. (mode 4)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_scale</strong> (<em>tuple</em><em> or </em><em>list</em><em>[</em><em>tuple</em><em>]</em>) – Images scales for resizing.</p></li>
<li><p><strong>multiscale_mode</strong> (<em>str</em>) – Either “range” or “value”.</p></li>
<li><p><strong>ratio_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>]</em>) – (min_ratio, max_ratio)</p></li>
<li><p><strong>keep_ratio</strong> (<em>bool</em>) – Whether to keep the aspect ratio when resizing the
image.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Resize.random_sample">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">random_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_scales</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Resize.random_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Resize.random_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly sample an img_scale when <code class="docutils literal notranslate"><span class="pre">multiscale_mode=='range'</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img_scales</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – Images scale range for sampling.
There must be two tuples in img_scales, which specify the lower
and uper bound of image scales.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Returns a tuple <code class="docutils literal notranslate"><span class="pre">(img_scale,</span> <span class="pre">None)</span></code>, where</dt><dd><p><code class="docutils literal notranslate"><span class="pre">img_scale</span></code> is sampled scale and None is just a placeholder
to be consistent with <a class="reference internal" href="#mmseg.datasets.pipelines.Resize.random_select" title="mmseg.datasets.pipelines.Resize.random_select"><code class="xref py py-func docutils literal notranslate"><span class="pre">random_select()</span></code></a>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(tuple, None)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Resize.random_sample_ratio">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">random_sample_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_range</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Resize.random_sample_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Resize.random_sample_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly sample an img_scale when <code class="docutils literal notranslate"><span class="pre">ratio_range</span></code> is specified.</p>
<p>A ratio will be randomly sampled from the range specified by
<code class="docutils literal notranslate"><span class="pre">ratio_range</span></code>. Then it would be multiplied with <code class="docutils literal notranslate"><span class="pre">img_scale</span></code> to
generate sampled scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_scale</strong> (<em>tuple</em>) – Images scale base to multiply with ratio.</p></li>
<li><p><strong>ratio_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>]</em>) – The minimum and maximum ratio to scale
the <code class="docutils literal notranslate"><span class="pre">img_scale</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Returns a tuple <code class="docutils literal notranslate"><span class="pre">(scale,</span> <span class="pre">None)</span></code>, where</dt><dd><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> is sampled ratio multiplied with <code class="docutils literal notranslate"><span class="pre">img_scale</span></code> and
None is just a placeholder to be consistent with
<a class="reference internal" href="#mmseg.datasets.pipelines.Resize.random_select" title="mmseg.datasets.pipelines.Resize.random_select"><code class="xref py py-func docutils literal notranslate"><span class="pre">random_select()</span></code></a>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(tuple, None)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Resize.random_select">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">random_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_scales</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#Resize.random_select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Resize.random_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly select an img_scale from given candidates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img_scales</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – Images scales for selection.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Returns a tuple <code class="docutils literal notranslate"><span class="pre">(img_scale,</span> <span class="pre">scale_dix)</span></code>,</dt><dd><p>where <code class="docutils literal notranslate"><span class="pre">img_scale</span></code> is the selected image scale and
<code class="docutils literal notranslate"><span class="pre">scale_idx</span></code> is the selected index in the given candidates.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(tuple, int)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.SegRescale">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">SegRescale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/transforms.html#SegRescale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.SegRescale" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescale semantic segmentation maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale_factor</strong> (<em>float</em>) – The scale factor of the final output.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.ToDataContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">ToDataContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">({'key':</span> <span class="pre">'img',</span> <span class="pre">'stack':</span> <span class="pre">True},</span> <span class="pre">{'key':</span> <span class="pre">'gt_semantic_seg'})</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#ToDataContainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.ToDataContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert results to <code class="xref py py-obj docutils literal notranslate"><span class="pre">mmcv.DataContainer</span></code> by given fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fields</strong> (<em>Sequence</em><em>[</em><em>dict</em><em>]</em>) – Each field is a dict like
<code class="docutils literal notranslate"><span class="pre">dict(key='xxx',</span> <span class="pre">**kwargs)</span></code>. The <code class="docutils literal notranslate"><span class="pre">key</span></code> in result will
be converted to <code class="xref py py-obj docutils literal notranslate"><span class="pre">mmcv.DataContainer</span></code> with <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">(dict(key='img',</span> <span class="pre">stack=True),</span>
<span class="pre">dict(key='gt_semantic_seg'))</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.ToTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">ToTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#ToTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.ToTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert some results to <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code> by given keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Keys that need to be converted to Tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.Transpose">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">Transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#Transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.Transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose some results by given keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Keys of results to be transposed.</p></li>
<li><p><strong>order</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Order of transpose.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.convert_and_compress_prediction_dir">
<span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">convert_and_compress_prediction_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agl_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uint16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tiff_adobe_deflate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conversion_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cm':</span> <span class="pre">100.0,</span> <span class="pre">'m':</span> <span class="pre">1.0}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/misc_utils.html#convert_and_compress_prediction_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.convert_and_compress_prediction_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert and compress prediction directory.
Default parameters are consistent with DrivenData platform submission requirements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.save_image">
<span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/misc_utils.html#save_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.save_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Note this function does not utilize conversion factors to meters, so implicitly assumes units are in meters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.datasets.pipelines.to_tensor">
<span class="sig-prename descclassname"><span class="pre">mmseg.datasets.pipelines.</span></span><span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/datasets/pipelines/formating.html#to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.datasets.pipelines.to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert objects of various python types to <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p>
<p>Supported types are: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em><em> | </em><em>numpy.ndarray</em><em> | </em><em>Sequence</em><em> | </em><em>int</em><em> | </em><em>float</em>) – Data to
be converted.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="mmseg-models">
<h1>mmseg.models<a class="headerlink" href="#mmseg-models" title="Permalink to this heading">¶</a></h1>
<section id="module-mmseg.models.segmentors">
<span id="segmentors"></span><h2>segmentors<a class="headerlink" href="#module-mmseg.models.segmentors" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.segmentors.CascadeEncoderDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.segmentors.</span></span><span class="sig-name descname"><span class="pre">CascadeEncoderDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_stages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neck</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/cascade_encoder_decoder.html#CascadeEncoderDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.CascadeEncoderDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Cascade Encoder Decoder segmentors.</p>
<p>CascadeEncoderDecoder almost the same as EncoderDecoder, while decoders of
CascadeEncoderDecoder are cascaded. The output of previous decoder_head
will be the input of next decoder_head.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.CascadeEncoderDecoder.encode_decode">
<span class="sig-name descname"><span class="pre">encode_decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/cascade_encoder_decoder.html#CascadeEncoderDecoder.encode_decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.CascadeEncoderDecoder.encode_decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode images with backbone and decode into a semantic segmentation
map of the same size as input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.CascadeEncoderDecoder.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/cascade_encoder_decoder.html#CascadeEncoderDecoder.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.CascadeEncoderDecoder.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone and heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.segmentors.</span></span><span class="sig-name descname"><span class="pre">EncoderDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neck</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder Decoder segmentors.
EncoderDecoder typically consists of backbone, decode_head, auxiliary_head.
Note that auxiliary_head is only used for deep supervision during training,
which could be dumped during inference.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.aug_test">
<span class="sig-name descname"><span class="pre">aug_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.aug_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.aug_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test with augmentations.
Only rescale=True is supported.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.encode_decode">
<span class="sig-name descname"><span class="pre">encode_decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.encode_decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.encode_decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode images with backbone and decode into a semantic segmentation
map of the same size as input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.extract_feat">
<span class="sig-name descname"><span class="pre">extract_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.extract_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.extract_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract features from images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.forward_dummy">
<span class="sig-name descname"><span class="pre">forward_dummy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.forward_dummy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.forward_dummy" title="Permalink to this definition">¶</a></dt>
<dd><p>Dummy forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.forward_train">
<span class="sig-name descname"><span class="pre">forward_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_semantic_seg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.forward_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.forward_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function for training.
:param img: Input images.
:type img: Tensor
:param img_metas: List of image info dict where each dict</p>
<blockquote>
<div><p>has: ‘img_shape’, ‘scale_factor’, ‘flip’, and may also contain
‘filename’, ‘ori_shape’, ‘pad_shape’, and ‘img_norm_cfg’.
For details on the values of these keys see
<cite>mmseg/datasets/pipelines/formatting.py:Collect</cite>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gt_semantic_seg</strong> (<em>Tensor</em>) – Semantic segmentation masks
used if the architecture supports semantic segmentation task.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary of loss components</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone and heads.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.simple_test">
<span class="sig-name descname"><span class="pre">simple_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.simple_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.simple_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple test with single image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.simple_test_ori">
<span class="sig-name descname"><span class="pre">simple_test_ori</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.simple_test_ori"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.simple_test_ori" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple test with single image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.slide_inference">
<span class="sig-name descname"><span class="pre">slide_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.slide_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.slide_inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference by sliding-window with overlap.
If h_crop &gt; h_img or w_crop &gt; w_img, the small patch will be used to
decode without padding.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.segmentors.EncoderDecoder.whole_inference">
<span class="sig-name descname"><span class="pre">whole_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/segmentors/encoder_decoder.html#EncoderDecoder.whole_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.segmentors.EncoderDecoder.whole_inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference with full image.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mmseg.models.backbones">
<span id="backbones"></span><h2>backbones<a class="headerlink" href="#module-mmseg.models.backbones" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.CGNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">CGNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">64,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">21)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reductions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'requires_grad':</span> <span class="pre">True,</span> <span class="pre">'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'PReLU'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/cgnet.html#CGNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.CGNet" title="Permalink to this definition">¶</a></dt>
<dd><p>CGNet backbone.</p>
<p>A Light-weight Context Guided Network for Semantic Segmentation
arXiv: <a class="reference external" href="https://arxiv.org/abs/1811.08201">https://arxiv.org/abs/1811.08201</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Normally 3.</p></li>
<li><p><strong>num_channels</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Numbers of feature channels at each stages.
Default: (32, 64, 128).</p></li>
<li><p><strong>num_blocks</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Numbers of CG blocks at stage 1 and stage 2.
Default: (3, 21).</p></li>
<li><p><strong>dilations</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Dilation rate for surrounding context
extractors at stage 1 and stage 2. Default: (2, 4).</p></li>
<li><p><strong>reductions</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Reductions for global context extractors at
stage 1 and stage 2. Default: (8, 16).</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em>) – Config dict for convolution layer.
Default: None, which means using conv2d.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – Config dict for normalization layer.
Default: dict(type=’BN’, requires_grad=True).</p></li>
<li><p><strong>act_cfg</strong> (<em>dict</em>) – Config dict for activation layer.
Default: dict(type=’PReLU’).</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only. Default: False.</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.CGNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/cgnet.html#CGNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.CGNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.CGNet.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/cgnet.html#CGNet.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.CGNet.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.CGNet.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/cgnet.html#CGNet.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.CGNet.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the model into training mode whill keeping the normalization
layer freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.FastSCNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">FastSCNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_dw_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">48)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_block_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">96,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_block_strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">higher_in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'ReLU'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/fast_scnn.html#FastSCNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.FastSCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast-SCNN Backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Default: 3.</p></li>
<li><p><strong>downsample_dw_channels</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of output channels after
the first conv layer &amp; the second conv layer in
Learning-To-Downsample (LTD) module.
Default: (32, 48).</p></li>
<li><p><strong>global_in_channels</strong> (<em>int</em>) – Number of input channels of
Global Feature Extractor(GFE).
Equal to number of output channels of LTD.
Default: 64.</p></li>
<li><p><strong>global_block_channels</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Tuple of integers that describe
the output channels for each of the MobileNet-v2 bottleneck
residual blocks in GFE.
Default: (64, 96, 128).</p></li>
<li><p><strong>global_block_strides</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Tuple of integers
that describe the strides (downsampling factors) for each of the
MobileNet-v2 bottleneck residual blocks in GFE.
Default: (2, 2, 1).</p></li>
<li><p><strong>global_out_channels</strong> (<em>int</em>) – Number of output channels of GFE.
Default: 128.</p></li>
<li><p><strong>higher_in_channels</strong> (<em>int</em>) – Number of input channels of the higher
resolution branch in FFM.
Equal to global_in_channels.
Default: 64.</p></li>
<li><p><strong>lower_in_channels</strong> (<em>int</em>) – Number of input channels of  the lower
resolution branch in FFM.
Equal to global_out_channels.
Default: 128.</p></li>
<li><p><strong>fusion_out_channels</strong> (<em>int</em>) – Number of output channels of FFM.
Default: 128.</p></li>
<li><p><strong>out_indices</strong> (<em>tuple</em>) – Tuple of indices of list
[higher_res_features, lower_res_features, fusion_output].
Often set to (0,1,2) to enable aux. heads.
Default: (0, 1, 2).</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config of conv layers. Default: None</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config of norm layers. Default:
dict(type=’BN’)</p></li>
<li><p><strong>act_cfg</strong> (<em>dict</em>) – Config of activation layers. Default:
dict(type=’ReLU’)</p></li>
<li><p><strong>align_corners</strong> (<em>bool</em>) – align_corners argument of F.interpolate.
Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.FastSCNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/fast_scnn.html#FastSCNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.FastSCNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">HRNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'requires_grad':</span> <span class="pre">True,</span> <span class="pre">'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_init_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/hrnet.html#HRNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.HRNet" title="Permalink to this definition">¶</a></dt>
<dd><p>HRNet backbone.</p>
<p>High-Resolution Representations for Labeling Pixels and Regions
arXiv: <a class="reference external" href="https://arxiv.org/abs/1904.04514">https://arxiv.org/abs/1904.04514</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extra</strong> (<em>dict</em>) – detailed configuration for each stage of HRNet.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Normally 3.</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em>) – dictionary to construct and config conv layer.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – dictionary to construct and config norm layer.</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only.</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed.</p></li>
<li><p><strong>zero_init_residual</strong> (<em>bool</em>) – whether to use zero init for last norm layer
in resblocks to let them behave as identity.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mmseg.models</span> <span class="kn">import</span> <span class="n">HRNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extra</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stage1</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_modules</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_branches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">block</span><span class="o">=</span><span class="s1">&#39;BOTTLENECK&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_blocks</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stage2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_modules</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_branches</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">block</span><span class="o">=</span><span class="s1">&#39;BASIC&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_blocks</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stage3</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_modules</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_branches</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">block</span><span class="o">=</span><span class="s1">&#39;BASIC&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_blocks</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stage4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_modules</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_branches</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">block</span><span class="o">=</span><span class="s1">&#39;BASIC&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_blocks</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">HRNet</span><span class="p">(</span><span class="n">extra</span><span class="p">,</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">level_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">level_out</span> <span class="ow">in</span> <span class="n">level_outputs</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">level_out</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">(1, 32, 8, 8)</span>
<span class="go">(1, 64, 4, 4)</span>
<span class="go">(1, 128, 2, 2)</span>
<span class="go">(1, 256, 1, 1)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/hrnet.html#HRNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.HRNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/hrnet.html#HRNet.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.HRNet.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet.norm1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norm1</span></span><a class="headerlink" href="#mmseg.models.backbones.HRNet.norm1" title="Permalink to this definition">¶</a></dt>
<dd><p>the normalization layer named “norm1”</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet.norm2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norm2</span></span><a class="headerlink" href="#mmseg.models.backbones.HRNet.norm2" title="Permalink to this definition">¶</a></dt>
<dd><p>the normalization layer named “norm2”</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.HRNet.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/hrnet.html#HRNet.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.HRNet.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the model into training mode whill keeping the normalization
layer freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">MobileNetV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">widen_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_stages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'ReLU6'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v2.html#MobileNetV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV2" title="Permalink to this definition">¶</a></dt>
<dd><p>MobileNetV2 backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>widen_factor</strong> (<em>float</em>) – Width multiplier, multiply number of
channels in each layer by this amount. Default: 1.0.</p></li>
<li><p><strong>strides</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Strides of the first block of each
layer. If not specified, default config in <code class="docutils literal notranslate"><span class="pre">arch_setting</span></code> will
be used.</p></li>
<li><p><strong>dilations</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Dilation of each layer.</p></li>
<li><p><strong>out_indices</strong> (<em>None</em><em> or </em><em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Output from which stages.
Default: (7, ).</p></li>
<li><p><strong>frozen_stages</strong> (<em>int</em>) – Stages to be frozen (all param fixed).
Default: -1, which means not freezing any parameters.</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em>) – Config dict for convolution layer.
Default: None, which means using conv2d.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – Config dict for normalization layer.
Default: dict(type=’BN’).</p></li>
<li><p><strong>act_cfg</strong> (<em>dict</em>) – Config dict for activation layer.
Default: dict(type=’ReLU6’).</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only. Default: False.</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v2.html#MobileNetV2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV2.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV2.make_layer">
<span class="sig-name descname"><span class="pre">make_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v2.html#MobileNetV2.make_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV2.make_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack InvertedResidual blocks to build a layer for MobileNetV2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_channels</strong> (<em>int</em>) – out_channels of block.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em>) – Number of blocks.</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – Stride of the first block.</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – Dilation of the first block.</p></li>
<li><p><strong>expand_ratio</strong> (<em>int</em>) – Expand the number of channels of the
hidden layer in InvertedResidual by this ratio.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV2.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v2.html#MobileNetV2.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV2.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the module in training mode.</p>
<p>This has any effect only on certain modules. See documentations of
particular modules for details of their behaviors in training/evaluation
mode, if they are affected, e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">Dropout</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchNorm</span></code>,
etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>bool</em>) – whether to set training mode (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or evaluation
mode (<code class="docutils literal notranslate"><span class="pre">False</span></code>). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>self</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">MobileNetV3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'small'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_stages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v3.html#MobileNetV3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV3" title="Permalink to this definition">¶</a></dt>
<dd><p>MobileNetV3 backbone.</p>
<p>This backbone is the improved implementation of <a class="reference external" href="https://ieeexplore.ieee.org/document/9008835">Searching for MobileNetV3</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arch</strong> (<em>str</em>) – Architechture of mobilnetv3, from {‘small’, ‘large’}.
Default: ‘small’.</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em>) – Config dict for convolution layer.
Default: None, which means using conv2d.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – Config dict for normalization layer.
Default: dict(type=’BN’).</p></li>
<li><p><strong>out_indices</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Output from which layer.
Default: (0, 1, 12).</p></li>
<li><p><strong>frozen_stages</strong> (<em>int</em>) – Stages to be frozen (all param fixed).
Defualt: -1, which means not freezing any parameters.</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only. Default: False.</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save
some memory while slowing down the training speed.
Defualt: False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v3.html#MobileNetV3.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV3.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.MobileNetV3.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/mobilenet_v3.html#MobileNetV3.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.MobileNetV3.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the module in training mode.</p>
<p>This has any effect only on certain modules. See documentations of
particular modules for details of their behaviors in training/evaluation
mode, if they are affected, e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">Dropout</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchNorm</span></code>,
etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>bool</em>) – whether to set training mode (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or evaluation
mode (<code class="docutils literal notranslate"><span class="pre">False</span></code>). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>self</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNeSt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">ResNeSt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_down_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnest.html#ResNeSt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNeSt" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNeSt backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>groups</strong> (<em>int</em>) – Number of groups of Bottleneck. Default: 1</p></li>
<li><p><strong>base_width</strong> (<em>int</em>) – Base width of Bottleneck. Default: 4</p></li>
<li><p><strong>radix</strong> (<em>int</em>) – Radix of SpltAtConv2d. Default: 2</p></li>
<li><p><strong>reduction_factor</strong> (<em>int</em>) – Reduction factor of inter_channels in
SplitAttentionConv2d. Default: 4.</p></li>
<li><p><strong>avg_down_stride</strong> (<em>bool</em>) – Whether to use average pool for stride in
Bottleneck. Default: True.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Keyword arguments for ResNet.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNeSt.make_res_layer">
<span class="sig-name descname"><span class="pre">make_res_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnest.html#ResNeSt.make_res_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNeSt.make_res_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack all blocks in a stage into a <code class="docutils literal notranslate"><span class="pre">ResLayer</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNeXt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">ResNeXt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnext.html#ResNeXt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNeXt" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNeXt backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<em>int</em>) – Depth of resnet, from {18, 34, 50, 101, 152}.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Normally 3.</p></li>
<li><p><strong>num_stages</strong> (<em>int</em>) – Resnet stages, normally 4.</p></li>
<li><p><strong>groups</strong> (<em>int</em>) – Group of resnext.</p></li>
<li><p><strong>base_width</strong> (<em>int</em>) – Base width of resnext.</p></li>
<li><p><strong>strides</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Strides of the first block of each stage.</p></li>
<li><p><strong>dilations</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Dilation of each stage.</p></li>
<li><p><strong>out_indices</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Output from which stages.</p></li>
<li><p><strong>style</strong> (<em>str</em>) – <cite>pytorch</cite> or <cite>caffe</cite>. If set to “pytorch”, the stride-two
layer is the 3x3 conv layer, otherwise the stride-two layer is
the first 1x1 conv layer.</p></li>
<li><p><strong>frozen_stages</strong> (<em>int</em>) – Stages to be frozen (all param fixed). -1 means
not freezing any parameters.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – dictionary to construct and config norm layer.</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only.</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed.</p></li>
<li><p><strong>zero_init_residual</strong> (<em>bool</em>) – whether to use zero init for last norm layer
in resblocks to let them behave as identity.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mmseg.models</span> <span class="kn">import</span> <span class="n">ResNeXt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ResNeXt</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">level_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">level_out</span> <span class="ow">in</span> <span class="n">level_outputs</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">level_out</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">(1, 256, 8, 8)</span>
<span class="go">(1, 512, 4, 4)</span>
<span class="go">(1, 1024, 2, 2)</span>
<span class="go">(1, 2048, 1, 1)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNeXt.make_res_layer">
<span class="sig-name descname"><span class="pre">make_res_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnext.html#ResNeXt.make_res_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNeXt.make_res_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack all blocks in a stage into a <code class="docutils literal notranslate"><span class="pre">ResLayer</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">ResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pytorch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_stem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_stages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'requires_grad':</span> <span class="pre">True,</span> <span class="pre">'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_with_dcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(False,</span> <span class="pre">False,</span> <span class="pre">False,</span> <span class="pre">False)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contract_dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_init_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNet backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<em>int</em>) – Depth of resnet, from {18, 34, 50, 101, 152}.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Default” 3.</p></li>
<li><p><strong>stem_channels</strong> (<em>int</em>) – Number of stem channels. Default: 64.</p></li>
<li><p><strong>base_channels</strong> (<em>int</em>) – Number of base channels of res layer. Default: 64.</p></li>
<li><p><strong>num_stages</strong> (<em>int</em>) – Resnet stages, normally 4.</p></li>
<li><p><strong>strides</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Strides of the first block of each stage.</p></li>
<li><p><strong>dilations</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Dilation of each stage.</p></li>
<li><p><strong>out_indices</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Output from which stages.</p></li>
<li><p><strong>style</strong> (<em>str</em>) – <cite>pytorch</cite> or <cite>caffe</cite>. If set to “pytorch”, the stride-two
layer is the 3x3 conv layer, otherwise the stride-two layer is
the first 1x1 conv layer.</p></li>
<li><p><strong>deep_stem</strong> (<em>bool</em>) – Replace 7x7 conv in input stem with 3 3x3 conv</p></li>
<li><p><strong>avg_down</strong> (<em>bool</em>) – Use AvgPool instead of stride conv when
downsampling in the bottleneck.</p></li>
<li><p><strong>frozen_stages</strong> (<em>int</em>) – Stages to be frozen (stop grad and set eval mode).
-1 means not freezing any parameters.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em>) – Dictionary to construct and config norm layer.</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only.</p></li>
<li><p><strong>plugins</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – <p>List of plugins for stages, each dict contains:</p>
<ul>
<li><p>cfg (dict, required): Cfg dict to build plugin.</p></li>
<li><p>position (str, required): Position inside block to insert plugin,</p></li>
</ul>
<p>options: ‘after_conv1’, ‘after_conv2’, ‘after_conv3’.</p>
<ul>
<li><p>stages (tuple[bool], optional): Stages to apply plugin, length</p></li>
</ul>
<p>should be same as ‘num_stages’</p>
</p></li>
<li><p><strong>multi_grid</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em><em>|</em><em>None</em>) – Multi grid dilation rates of last
stage. Default: None</p></li>
<li><p><strong>contract_dilation</strong> (<em>bool</em>) – Whether contract first dilation of each layer
Default: False</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed.</p></li>
<li><p><strong>zero_init_residual</strong> (<em>bool</em>) – Whether to use zero init for last norm layer
in resblocks to let them behave as identity.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mmseg.models</span> <span class="kn">import</span> <span class="n">ResNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ResNet</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">level_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">level_out</span> <span class="ow">in</span> <span class="n">level_outputs</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">level_out</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">(1, 64, 8, 8)</span>
<span class="go">(1, 128, 4, 4)</span>
<span class="go">(1, 256, 2, 2)</span>
<span class="go">(1, 512, 1, 1)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.make_res_layer">
<span class="sig-name descname"><span class="pre">make_res_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet.make_res_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet.make_res_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack all blocks in a stage into a <code class="docutils literal notranslate"><span class="pre">ResLayer</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.make_stage_plugins">
<span class="sig-name descname"><span class="pre">make_stage_plugins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plugins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet.make_stage_plugins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet.make_stage_plugins" title="Permalink to this definition">¶</a></dt>
<dd><p>make plugins for ResNet ‘stage_idx’th stage .</p>
<p>Currently we support to insert ‘context_block’,
‘empirical_attention_block’, ‘nonlocal_block’ into the backbone like
ResNet/ResNeXt. They could be inserted after conv1/conv2/conv3 of
Bottleneck.</p>
<p>An example of plugins format could be :
&gt;&gt;&gt; plugins=[
…     dict(cfg=dict(type=’xxx’, arg1=’xxx’),
…          stages=(False, True, True, True),
…          position=’after_conv2’),
…     dict(cfg=dict(type=’yyy’),
…          stages=(True, True, True, True),
…          position=’after_conv3’),
…     dict(cfg=dict(type=’zzz’, postfix=’1’),
…          stages=(True, True, True, True),
…          position=’after_conv3’),
…     dict(cfg=dict(type=’zzz’, postfix=’2’),
…          stages=(True, True, True, True),
…          position=’after_conv3’)
… ]
&gt;&gt;&gt; self = ResNet(depth=18)
&gt;&gt;&gt; stage_plugins = self.make_stage_plugins(plugins, 0)
&gt;&gt;&gt; assert len(stage_plugins) == 3</p>
<dl class="simple">
<dt>Suppose ‘stage_idx=0’, the structure of blocks in the stage would be:</dt><dd><p>conv1-&gt; conv2-&gt;conv3-&gt;yyy-&gt;zzz1-&gt;zzz2</p>
</dd>
<dt>Suppose ‘stage_idx=1’, the structure of blocks in the stage would be:</dt><dd><p>conv1-&gt; conv2-&gt;xxx-&gt;conv3-&gt;yyy-&gt;zzz1-&gt;zzz2</p>
</dd>
</dl>
<p>If stages is missing, the plugin would be applied to all stages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plugins</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – List of plugins cfg to build. The postfix is
required if multiple same type plugins are inserted.</p></li>
<li><p><strong>stage_idx</strong> (<em>int</em>) – Index of stage to build</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Plugins for current stage</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.norm1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norm1</span></span><a class="headerlink" href="#mmseg.models.backbones.ResNet.norm1" title="Permalink to this definition">¶</a></dt>
<dd><p>the normalization layer named “norm1”</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNet.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNet.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNet.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the model into training mode while keep normalization layer
freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNetV1c">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">ResNetV1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNetV1c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNetV1c" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNetV1c variant described in <a class="footnote-reference brackets" href="#id2" id="id1">1</a>.</p>
<p>Compared with default ResNet(ResNetV1b), ResNetV1c replaces the 7x7 conv
in the input stem with three 3x3 convs.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p><a class="reference external" href="https://arxiv.org/pdf/1812.01187.pdf">https://arxiv.org/pdf/1812.01187.pdf</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.ResNetV1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">ResNetV1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/resnet.html#ResNetV1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.ResNetV1d" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNetV1d variant described in <a class="footnote-reference brackets" href="#id2" id="id3">1</a>.</p>
<p>Compared with default ResNet(ResNetV1b), ResNetV1d replaces the 7x7 conv in
the input stem with three 3x3 convs. And in the downsampling block, a 2x2
avg_pool with stride 2 is added before conv, whose stride is changed to 1.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.SwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">SwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size=224,</span> <span class="pre">patch_size=4,</span> <span class="pre">in_chans=3,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2],</span> <span class="pre">num_heads=[3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24],</span> <span class="pre">window_size=7,</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">ape=False,</span> <span class="pre">patch_norm=True,</span> <span class="pre">out_indices=(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">frozen_stages=-1,</span> <span class="pre">use_checkpoint=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/swin_transformer.html#SwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.SwinTransformer" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Swin Transformer backbone.</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pretrain_img_size</strong> (<em>int</em>) – Input image size for training the pretrained model,
used in absolute postion embedding. Default 224.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Patch size. Default: 4.</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input image channels. Default: 3.</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Number of linear projection output channels. Default: 96.</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Depths of each Swin Transformer stage.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of attention head of each stage.</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Window size. Default: 7.</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>) – Override default qk scale of head_dim ** -0.5 if set.</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>) – Dropout rate.</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>) – Attention dropout rate. Default: 0.</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>) – Stochastic depth rate. Default: 0.2.</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>) – Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>) – If True, add absolute position embedding to the patch embedding. Default: False.</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>) – If True, add normalization after patch embedding. Default: True.</p></li>
<li><p><strong>out_indices</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Output from which stages.</p></li>
<li><p><strong>frozen_stages</strong> (<em>int</em>) – Stages to be frozen (stop grad and set eval mode).
-1 means not freezing any parameters.</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.SwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/swin_transformer.html#SwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.SwinTransformer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.SwinTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/swin_transformer.html#SwinTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.SwinTransformer.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.SwinTransformer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/swin_transformer.html#SwinTransformer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.SwinTransformer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.backbones.UNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.backbones.</span></span><span class="sig-name descname"><span class="pre">UNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True,</span> <span class="pre">True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'BN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'ReLU'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'InterpConv'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/unet.html#UNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.UNet" title="Permalink to this definition">¶</a></dt>
<dd><p>UNet backbone.
U-Net: Convolutional Networks for Biomedical Image Segmentation.
<a class="reference external" href="https://arxiv.org/pdf/1505.04597.pdf">https://arxiv.org/pdf/1505.04597.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input image channels. Default” 3.</p></li>
<li><p><strong>base_channels</strong> (<em>int</em>) – Number of base channels of each stage.
The output channels of the first stage. Default: 64.</p></li>
<li><p><strong>num_stages</strong> (<em>int</em>) – Number of stages in encoder, normally 5. Default: 5.</p></li>
<li><p><strong>strides</strong> (<em>Sequence</em><em>[</em><em>int 1</em><em> | </em><em>2</em><em>]</em>) – Strides of each stage in encoder.
len(strides) is equal to num_stages. Normally the stride of the
first stage in encoder is 1. If strides[i]=2, it uses stride
convolution to downsample in the correspondance encoder stage.
Default: (1, 1, 1, 1, 1).</p></li>
<li><p><strong>enc_num_convs</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Number of convolutional layers in the
convolution block of the correspondance encoder stage.
Default: (2, 2, 2, 2, 2).</p></li>
<li><p><strong>dec_num_convs</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Number of convolutional layers in the
convolution block of the correspondance decoder stage.
Default: (2, 2, 2, 2).</p></li>
<li><p><strong>downsamples</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Whether use MaxPool to downsample the
feature map after the first stage of encoder
(stages: [1, num_stages)). If the correspondance encoder stage use
stride convolution (strides[i]=2), it will never use MaxPool to
downsample, even downsamples[i-1]=True.
Default: (True, True, True, True).</p></li>
<li><p><strong>enc_dilations</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Dilation rate of each stage in encoder.
Default: (1, 1, 1, 1, 1).</p></li>
<li><p><strong>dec_dilations</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Dilation rate of each stage in decoder.
Default: (1, 1, 1, 1).</p></li>
<li><p><strong>with_cp</strong> (<em>bool</em>) – Use checkpoint or not. Using checkpoint will save some
memory while slowing down the training speed. Default: False.</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config dict for convolution layer.
Default: None.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config dict for normalization layer.
Default: dict(type=’BN’).</p></li>
<li><p><strong>act_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config dict for activation layer in ConvModule.
Default: dict(type=’ReLU’).</p></li>
<li><p><strong>upsample_cfg</strong> (<em>dict</em>) – The upsample config of the upsample module in
decoder. Default: dict(type=’InterpConv’).</p></li>
<li><p><strong>norm_eval</strong> (<em>bool</em>) – Whether to set norm layers to eval mode, namely,
freeze running stats (mean and var). Note: Effect on Batch Norm
and its variants only. Default: False.</p></li>
<li><p><strong>dcn</strong> (<em>bool</em>) – Use deformable convoluton in convolutional layer or not.
Default: None.</p></li>
<li><p><strong>plugins</strong> (<em>dict</em>) – plugins for convolutional layers. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Notice:</dt><dd><p>The input image size should be devisible by the whole downsample rate
of the encoder. More detail of the whole downsample rate can be found
in UNet._check_input_devisible.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.UNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/unet.html#UNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.UNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.UNet.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/unet.html#UNet.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.UNet.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to pre-trained weights.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.backbones.UNet.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/backbones/unet.html#UNet.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.backbones.UNet.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the model into training mode while keep normalization layer
freezed.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mmseg.models.decode_heads">
<span id="decode-heads"></span><h2>decode_heads<a class="headerlink" href="#module-mmseg.models.decode_heads" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.ANNHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">ANNHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pool_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">6,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ann_head.html#ANNHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.ANNHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Asymmetric Non-local Neural Networks for Semantic Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1908.07678">ANNNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>project_channels</strong> (<em>int</em>) – Projection channels for Nonlocal.</p></li>
<li><p><strong>query_scales</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The scales of query feature map.
Default: (1,)</p></li>
<li><p><strong>key_pool_scales</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The pooling scales of key feature map.
Default: (1, 3, 6, 8).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.ANNHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ann_head.html#ANNHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.ANNHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.APCHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">APCHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/apc_head.html#APCHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.APCHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Adaptive Pyramid Context Network for Semantic Segmentation.</p>
<p>This head is the implementation of
<a class="reference external" href="https://openaccess.thecvf.com/content_CVPR_2019/papers/He_Adaptive_Pyramid_Context_Network_for_Semantic_Segmentation_CVPR_2019_paper.pdf">APCNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool_scales</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Pooling scales used in Adaptive Context
Module. Default: (1, 2, 3, 6).</p></li>
<li><p><strong>fusion</strong> (<em>bool</em>) – Add one conv to fuse residual feature.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.APCHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/apc_head.html#APCHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.APCHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.ASPPHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">ASPPHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">18)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/aspp_head.html#ASPPHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.ASPPHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Rethinking Atrous Convolution for Semantic Image Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1706.05587">DeepLabV3</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dilations</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Dilation rates for ASPP module.
Default: (1, 6, 12, 18).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.ASPPHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/aspp_head.html#ASPPHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.ASPPHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.CCHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">CCHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recurrence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/cc_head.html#CCHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.CCHead" title="Permalink to this definition">¶</a></dt>
<dd><p>CCNet: Criss-Cross Attention for Semantic Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1811.11721">CCNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>recurrence</strong> (<em>int</em>) – Number of recurrence of Criss Cross Attention
module. Default: 2.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.CCHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/cc_head.html#CCHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.CCHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">DAHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pam_channels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Dual Attention Network for Scene Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1809.02983">DANet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pam_channels</strong> (<em>int</em>) – The channels of Position Attention Module(PAM).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead.cam_cls_seg">
<span class="sig-name descname"><span class="pre">cam_cls_seg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead.cam_cls_seg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead.cam_cls_seg" title="Permalink to this definition">¶</a></dt>
<dd><p>CAM feature classification.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead.forward_test">
<span class="sig-name descname"><span class="pre">forward_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead.forward_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead.forward_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function for testing, only <code class="docutils literal notranslate"><span class="pre">pam_cam</span></code> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead.losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <code class="docutils literal notranslate"><span class="pre">pam_cam</span></code>, <code class="docutils literal notranslate"><span class="pre">pam</span></code>, <code class="docutils literal notranslate"><span class="pre">cam</span></code> loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DAHead.pam_cls_seg">
<span class="sig-name descname"><span class="pre">pam_cls_seg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/da_head.html#DAHead.pam_cls_seg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DAHead.pam_cls_seg" title="Permalink to this definition">¶</a></dt>
<dd><p>PAM feature classification.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DMHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">DMHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/dm_head.html#DMHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DMHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamic Multi-scale Filters for Semantic Segmentation.</p>
<p>This head is the implementation of
<a class="reference external" href="https://openaccess.thecvf.com/content_ICCV_2019/papers/He_Dynamic_Multi-Scale_Filters_for_Semantic_Segmentation_ICCV_2019_paper.pdf">DMNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter_sizes</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The size of generated convolutional filters
used in Dynamic Convolutional Module. Default: (1, 3, 5, 7).</p></li>
<li><p><strong>fusion</strong> (<em>bool</em>) – Add one conv to fuse DCM output feature.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DMHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/dm_head.html#DMHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DMHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DNLHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">DNLHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'embedded_gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/dnl_head.html#DNLHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DNLHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Disentangled Non-Local Neural Networks.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/2006.06668">DNLNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduction</strong> (<em>int</em>) – Reduction factor of projection transform. Default: 2.</p></li>
<li><p><strong>use_scale</strong> (<em>bool</em>) – Whether to scale pairwise_weight by
sqrt(1/inter_channels). Default: False.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The nonlocal mode. Options are ‘embedded_gaussian’,
‘dot_product’. Default: ‘embedded_gaussian.’.</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – Temperature to adjust attention. Default: 0.05</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DNLHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/dnl_head.html#DNLHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DNLHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DepthwiseSeparableASPPHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">DepthwiseSeparableASPPHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1_in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1_channels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/sep_aspp_head.html#DepthwiseSeparableASPPHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DepthwiseSeparableASPPHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder-Decoder with Atrous Separable Convolution for Semantic Image
Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1802.02611">DeepLabV3+</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c1_in_channels</strong> (<em>int</em>) – The input channels of c1 decoder. If is 0,
the no decoder will be used.</p></li>
<li><p><strong>c1_channels</strong> (<em>int</em>) – The intermediate channels of c1 decoder.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DepthwiseSeparableASPPHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/sep_aspp_head.html#DepthwiseSeparableASPPHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DepthwiseSeparableASPPHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.DepthwiseSeparableFCNHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">DepthwiseSeparableFCNHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/sep_fcn_head.html#DepthwiseSeparableFCNHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.DepthwiseSeparableFCNHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Depthwise-Separable Fully Convolutional Network for Semantic
Segmentation.</p>
<p>This head is implemented according to Fast-SCNN paper.
:param in_channels: Number of output channels of FFM.
:type in_channels: int
:param channels: Number of middle-stage channels in the decode head.
:type channels: int
:param concat_input: Whether to concatenate original decode input into</p>
<blockquote>
<div><p>the result of several consecutive convolution layers.
Default: True.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<em>int</em>) – Used to determine the dimension of
final prediction tensor.</p></li>
<li><p><strong>in_index</strong> (<em>int</em>) – Correspond with ‘out_indices’ in FastSCNN backbone.</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em><em> | </em><em>None</em>) – Config of norm layers.</p></li>
<li><p><strong>align_corners</strong> (<em>bool</em>) – align_corners argument of F.interpolate.
Default: False.</p></li>
<li><p><strong>loss_decode</strong> (<em>dict</em>) – Config of loss type and some
relevant additional options.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EMAHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">EMAHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ema_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ema_head.html#EMAHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EMAHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Expectation Maximization Attention Networks for Semantic Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1907.13426">EMANet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ema_channels</strong> (<em>int</em>) – EMA module channels</p></li>
<li><p><strong>num_bases</strong> (<em>int</em>) – Number of bases.</p></li>
<li><p><strong>num_stages</strong> (<em>int</em>) – Number of the EM iterations.</p></li>
<li><p><strong>concat_input</strong> (<em>bool</em>) – Whether concat the input and output of convs
before classification layer. Default: True</p></li>
<li><p><strong>momentum</strong> (<em>float</em>) – Momentum to update the base. Default: 0.1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EMAHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ema_head.html#EMAHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EMAHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EncHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">EncHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_codes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_se_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_lateral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_se_decode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'loss_weight':</span> <span class="pre">0.2,</span> <span class="pre">'type':</span> <span class="pre">'CrossEntropyLoss',</span> <span class="pre">'use_sigmoid':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/enc_head.html#EncHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EncHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Context Encoding for Semantic Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1803.08904">EncNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_codes</strong> (<em>int</em>) – Number of code words. Default: 32.</p></li>
<li><p><strong>use_se_loss</strong> (<em>bool</em>) – Whether use Semantic Encoding Loss (SE-loss) to
regularize the training. Default: True.</p></li>
<li><p><strong>add_lateral</strong> (<em>bool</em>) – Whether use lateral connection to fuse features.
Default: False.</p></li>
<li><p><strong>loss_se_decode</strong> (<em>dict</em>) – Config of decode loss.
Default: dict(type=’CrossEntropyLoss’, use_sigmoid=True).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EncHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/enc_head.html#EncHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EncHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EncHead.forward_test">
<span class="sig-name descname"><span class="pre">forward_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/enc_head.html#EncHead.forward_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EncHead.forward_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function for testing, ignore se_loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.EncHead.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/enc_head.html#EncHead.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.EncHead.losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute segmentation and semantic encoding loss.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.FCNHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">FCNHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/fcn_head.html#FCNHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.FCNHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully Convolution Networks for Semantic Segmentation.
This head is implemented of <a class="reference external" href="https://arxiv.org/abs/1411.4038">FCNNet</a>.
:param num_convs: Number of convs in the head. Default: 2.
:type num_convs: int
:param kernel_size: The kernel size for convs in the head. Default: 3.
:type kernel_size: int
:param concat_input: Whether concat the input and output of convs</p>
<blockquote>
<div><p>before classification layer.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.FCNHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/fcn_head.html#FCNHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.FCNHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.FPNHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">FPNHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_strides</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/fpn_head.html#FPNHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.FPNHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Panoptic Feature Pyramid Networks.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1901.02446">Semantic FPN</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>feature_strides</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The strides for input feature maps.
stack_lateral. All strides suppose to be power of 2. The first
one is of largest resolution.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.FPNHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/fpn_head.html#FPNHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.FPNHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Placeholder of forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.GCHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">GCHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'att'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('channel_add',)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/gc_head.html#GCHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.GCHead" title="Permalink to this definition">¶</a></dt>
<dd><p>GCNet: Non-local Networks Meet Squeeze-Excitation Networks and Beyond.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1904.11492">GCNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratio</strong> (<em>float</em>) – Multiplier of channels ratio. Default: 1/4.</p></li>
<li><p><strong>pooling_type</strong> (<em>str</em>) – The pooling type of context aggregation.
Options are ‘att’, ‘avg’. Default: ‘avg’.</p></li>
<li><p><strong>fusion_types</strong> (<em>tuple</em><em>[</em><em>str</em><em>]</em>) – The fusion type for feature fusion.
Options are ‘channel_add’, ‘channel_mul’. Defautl: (‘channel_add’,)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.GCHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/gc_head.html#GCHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.GCHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.LRASPPHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">LRASPPHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/lraspp_head.html#LRASPPHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.LRASPPHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Lite R-ASPP (LRASPP) head is proposed in Searching for MobileNetV3.</p>
<p>This head is the improved implementation of <a class="reference external" href="https://ieeexplore.ieee.org/document/9008835">Searching for MobileNetV3</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_channels</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The number of output channels in every
each branch. Default: (32, 64).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.LRASPPHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/lraspp_head.html#LRASPPHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.LRASPPHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.NLHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">NLHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'embedded_gaussian'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/nl_head.html#NLHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.NLHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-local Neural Networks.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1711.07971">NLNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduction</strong> (<em>int</em>) – Reduction factor of projection transform. Default: 2.</p></li>
<li><p><strong>use_scale</strong> (<em>bool</em>) – Whether to scale pairwise_weight by
sqrt(1/inter_channels). Default: True.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The nonlocal mode. Options are ‘embedded_gaussian’,
‘dot_product’. Default: ‘embedded_gaussian.’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.NLHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/nl_head.html#NLHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.NLHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.OCRHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">OCRHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ocr_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ocr_head.html#OCRHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.OCRHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Object-Contextual Representations for Semantic Segmentation.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1909.11065">OCRNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ocr_channels</strong> (<em>int</em>) – The intermediate channels of OCR block.</p></li>
<li><p><strong>scale</strong> (<em>int</em>) – The scale of probability map in SpatialGatherModule in
Default: 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.OCRHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/ocr_head.html#OCRHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.OCRHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PSAHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">PSAHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psa_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bi-direction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psa_softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/psa_head.html#PSAHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PSAHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Point-wise Spatial Attention Network for Scene Parsing.</p>
<p>This head is the implementation of <a class="reference external" href="https://hszhao.github.io/papers/eccv18_psanet.pdf">PSANet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The PSA mask size. It usually equals input
size.</p></li>
<li><p><strong>psa_type</strong> (<em>str</em>) – The type of psa module. Options are ‘collect’,
‘distribute’, ‘bi-direction’. Default: ‘bi-direction’</p></li>
<li><p><strong>compact</strong> (<em>bool</em>) – Whether use compact map for ‘collect’ mode.
Default: True.</p></li>
<li><p><strong>shrink_factor</strong> (<em>int</em>) – The downsample factors of psa mask. Default: 2.</p></li>
<li><p><strong>normalization_factor</strong> (<em>float</em>) – The normalize factor of attention.</p></li>
<li><p><strong>psa_softmax</strong> (<em>bool</em>) – Whether use softmax for attention.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PSAHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/psa_head.html#PSAHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PSAHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PSPHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">PSPHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/psp_head.html#PSPHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PSPHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Pyramid Scene Parsing Network.</p>
<p>This head is the implementation of
<a class="reference external" href="https://arxiv.org/abs/1612.01105">PSPNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pool_scales</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Pooling scales used in Pooling Pyramid
Module. Default: (1, 2, 3, 6).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PSPHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/psp_head.html#PSPHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PSPHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">PointHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_fcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse_pred_each_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'Conv1d'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'inplace':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'ReLU'}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead" title="Permalink to this definition">¶</a></dt>
<dd><p>A mask point head use in PointRend.</p>
<p><code class="docutils literal notranslate"><span class="pre">PointHead</span></code> use shared multi-layer perceptron (equivalent to
nn.Conv1d) to predict the logit of input points. The fine-grained feature
and coarse feature will be concatenate together for predication.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_fcs</strong> (<em>int</em>) – Number of fc layers in the head. Default: 3.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input channels. Default: 256.</p></li>
<li><p><strong>fc_channels</strong> (<em>int</em>) – Number of fc channels. Default: 256.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes for logits. Default: 80.</p></li>
<li><p><strong>class_agnostic</strong> (<em>bool</em>) – Whether use class agnostic classification.
If so, the output channels of logits will be 1. Default: False.</p></li>
<li><p><strong>coarse_pred_each_layer</strong> (<em>bool</em>) – Whether concatenate coarse feature with
the output of each fc layer. Default: True.</p></li>
<li><p><strong>conv_cfg</strong> (<em>dict</em><em>|</em><em>None</em>) – Dictionary to construct and config conv layer.
Default: dict(type=’Conv1d’))</p></li>
<li><p><strong>norm_cfg</strong> (<em>dict</em><em>|</em><em>None</em>) – Dictionary to construct and config norm layer.
Default: None.</p></li>
<li><p><strong>loss_point</strong> (<em>dict</em>) – Dictionary to construct and config loss layer of
point head. Default: dict(type=’CrossEntropyLoss’, use_mask=True,
loss_weight=1.0).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.cls_seg">
<span class="sig-name descname"><span class="pre">cls_seg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.cls_seg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.cls_seg" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify each pixel with fc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fine_grained_point_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse_point_feats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Placeholder of forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.forward_test">
<span class="sig-name descname"><span class="pre">forward_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.forward_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.forward_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list</em><em>[</em><em>Tensor</em><em>]</em>) – List of multi-level img features.</p></li>
<li><p><strong>prev_output</strong> (<em>Tensor</em>) – The output of previous decode head.</p></li>
<li><p><strong>img_metas</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – List of image info dict where each dict
has: ‘img_shape’, ‘scale_factor’, ‘flip’, and may also contain
‘filename’, ‘ori_shape’, ‘pad_shape’, and ‘img_norm_cfg’.
For details on the values of these keys see
<cite>mmseg/datasets/pipelines/formatting.py:Collect</cite>.</p></li>
<li><p><strong>test_cfg</strong> (<em>dict</em>) – The testing config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output segmentation map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.forward_train">
<span class="sig-name descname"><span class="pre">forward_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_semantic_seg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.forward_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.forward_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function for training.
:param inputs: List of multi-level img features.
:type inputs: list[Tensor]
:param prev_output: The output of previous decode head.
:type prev_output: Tensor
:param img_metas: List of image info dict where each dict</p>
<blockquote>
<div><p>has: ‘img_shape’, ‘scale_factor’, ‘flip’, and may also contain
‘filename’, ‘ori_shape’, ‘pad_shape’, and ‘img_norm_cfg’.
For details on the values of these keys see
<cite>mmseg/datasets/pipelines/formatting.py:Collect</cite>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gt_semantic_seg</strong> (<em>Tensor</em>) – Semantic segmentation masks
used if the architecture supports semantic segmentation task.</p></li>
<li><p><strong>train_cfg</strong> (<em>dict</em>) – The training config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary of loss components</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.get_points_test">
<span class="sig-name descname"><span class="pre">get_points_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.get_points_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.get_points_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample points for testing.</p>
<p>Find <code class="docutils literal notranslate"><span class="pre">num_points</span></code> most uncertain points from <code class="docutils literal notranslate"><span class="pre">uncertainty_map</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_logits</strong> (<em>Tensor</em>) – A tensor of shape (batch_size, num_classes,
height, width) for class-specific or class-agnostic prediction.</p></li>
<li><p><strong>uncertainty_func</strong> (<em>func</em>) – uncertainty calculation function.</p></li>
<li><p><strong>cfg</strong> (<em>dict</em>) – Testing config of point head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tensor of shape (batch_size, num_points)</dt><dd><p>that contains indices from [0, height x width) of the most
uncertain points.</p>
</dd>
<dt>point_coords (Tensor): A tensor of shape (batch_size, num_points,</dt><dd><p>2) that contains [0, 1] x [0, 1] normalized coordinates of the
most uncertain points from the <code class="docutils literal notranslate"><span class="pre">height</span> <span class="pre">x</span> <span class="pre">width</span></code> grid .</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>point_indices (Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.get_points_train">
<span class="sig-name descname"><span class="pre">get_points_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.get_points_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.get_points_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample points for training.</p>
<p>Sample points in [0, 1] x [0, 1] coordinate space based on their
uncertainty. The uncertainties are calculated for each point using
‘uncertainty_func’ function that takes point’s logit prediction as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_logits</strong> (<em>Tensor</em>) – Semantic segmentation logits, shape (
batch_size, num_classes, height, width).</p></li>
<li><p><strong>uncertainty_func</strong> (<em>func</em>) – uncertainty calculation function.</p></li>
<li><p><strong>cfg</strong> (<em>dict</em>) – Training config of point head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tensor of shape (batch_size, num_points,</dt><dd><p>2) that contains the coordinates of <code class="docutils literal notranslate"><span class="pre">num_points</span></code> sampled
points.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>point_coords (Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.init_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize weights of classification layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.PointHead.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/point_head.html#PointHead.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.PointHead.losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute segmentation loss.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.UPerHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.decode_heads.</span></span><span class="sig-name descname"><span class="pre">UPerHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/uper_head_base.html#UPerHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.UPerHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Unified Perceptual Parsing for Scene Understanding.</p>
<p>This head is the implementation of <a class="reference external" href="https://arxiv.org/abs/1807.10221">UPerNet</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pool_scales</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Pooling scales used in Pooling Pyramid
Module applied on the last feature. Default: (1, 2, 3, 6).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.UPerHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/uper_head_base.html#UPerHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.UPerHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.decode_heads.UPerHead.psp_forward">
<span class="sig-name descname"><span class="pre">psp_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/decode_heads/uper_head_base.html#UPerHead.psp_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.decode_heads.UPerHead.psp_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function of PSP module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mmseg.models.losses">
<span id="losses"></span><h2>losses<a class="headerlink" href="#module-mmseg.models.losses" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.losses.Accuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">Accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/accuracy.html#Accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.Accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Accuracy calculation module.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.losses.Accuracy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/accuracy.html#Accuracy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.Accuracy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function to calculate accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>torch.Tensor</em>) – Prediction of models.</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Target for each prediction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The accuracies under different topk criterions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.losses.CrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">CrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/cross_entropy_loss.html#CrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.CrossEntropyLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>CrossEntropyLoss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_sigmoid</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the prediction uses sigmoid
of softmax. Defaults to False.</p></li>
<li><p><strong>use_mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use mask cross entropy loss.
Defaults to False.</p></li>
<li><p><strong>reduction</strong> (<em>str</em><em>, </em><em>optional</em>) – . Defaults to ‘mean’.
Options are “none”, “mean” and “sum”.</p></li>
<li><p><strong>class_weight</strong> (<em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Weight of each class.
Defaults to None.</p></li>
<li><p><strong>loss_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight of the loss. Defaults to 1.0.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.losses.CrossEntropyLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/cross_entropy_loss.html#CrossEntropyLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.CrossEntropyLoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.losses.LovaszLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">LovaszLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multi_class'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'present'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/lovasz_loss.html#LovaszLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.LovaszLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>LovaszLoss.</p>
<p>This loss is proposed in <a class="reference external" href="https://arxiv.org/abs/1705.08790">The Lovasz-Softmax loss: A tractable surrogate
for the optimization of the intersection-over-union measure in neural
networks</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Binary or multi-class loss.
Default: ‘multi_class’. Options are “binary” and “multi_class”.</p></li>
<li><p><strong>classes</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Classes choosed to calculate loss.
‘all’ for all classes, ‘present’ for classes present in labels, or
a list of classes to average. Default: ‘present’.</p></li>
<li><p><strong>per_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If per_image is True, compute the loss per
image instead of per batch. Default: False.</p></li>
<li><p><strong>reduction</strong> (<em>str</em><em>, </em><em>optional</em>) – The method used to reduce the loss. Options
are “none”, “mean” and “sum”. This parameter only works when
per_image is True. Default: ‘mean’.</p></li>
<li><p><strong>class_weight</strong> (<em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The weight for each class.
Default: None.</p></li>
<li><p><strong>loss_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight of the loss. Defaults to 1.0.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.losses.LovaszLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/lovasz_loss.html#LovaszLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.LovaszLoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.losses.MSELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">MSELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/mse_loss.html#MSELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.MSELoss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.losses.MSELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/mse_loss.html#MSELoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.MSELoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmseg.models.losses.NoNaNMSE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">NoNaNMSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/mse_loss.html#NoNaNMSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.NoNaNMSE" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mmseg.models.losses.NoNaNMSE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/mse_loss.html#NoNaNMSE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.NoNaNMSE.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.accuracy">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/accuracy.html#accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate accuracy according to the prediction and target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>torch.Tensor</em>) – The model prediction, shape (N, num_class, …)</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – The target of each prediction, shape (N, , …)</p></li>
<li><p><strong>topk</strong> (<em>int</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – If the predictions in <code class="docutils literal notranslate"><span class="pre">topk</span></code>
matches the target, the predictions will be regarded as
correct ones. Defaults to 1.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – If not None, predictions with scores under
this threshold are considered incorrect. Default to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>If the input <code class="docutils literal notranslate"><span class="pre">topk</span></code> is a single integer,</dt><dd><p>the function will return a single float as accuracy. If
<code class="docutils literal notranslate"><span class="pre">topk</span></code> is a tuple containing multiple integers, the
function will return a tuple containing accuracies of
each <code class="docutils literal notranslate"><span class="pre">topk</span></code> number.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float | tuple[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.binary_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">binary_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/cross_entropy_loss.html#binary_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.binary_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the binary CrossEntropy loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>torch.Tensor</em>) – The prediction with shape (N, 1).</p></li>
<li><p><strong>label</strong> (<em>torch.Tensor</em>) – The learning label of the prediction.</p></li>
<li><p><strong>weight</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Sample-wise loss weight.</p></li>
<li><p><strong>reduction</strong> (<em>str</em><em>, </em><em>optional</em>) – The method used to reduce the loss.
Options are “none”, “mean” and “sum”.</p></li>
<li><p><strong>avg_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – Average factor that is used to average
the loss. Defaults to None.</p></li>
<li><p><strong>class_weight</strong> (<em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The weight for each class.</p></li>
<li><p><strong>ignore_index</strong> (<em>int</em><em> | </em><em>None</em>) – The label index to be ignored. Default: 255</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.cross_entropy">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/cross_entropy_loss.html#cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>The wrapper function for <code class="xref py py-func docutils literal notranslate"><span class="pre">F.cross_entropy()</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.mask_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">mask_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/cross_entropy_loss.html#mask_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.mask_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the CrossEntropy loss for masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>torch.Tensor</em>) – The prediction with shape (N, C), C is the number
of classes.</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – The learning label of the prediction.</p></li>
<li><p><strong>label</strong> (<em>torch.Tensor</em>) – <code class="docutils literal notranslate"><span class="pre">label</span></code> indicates the class label of the mask’
corresponding object. This will be used to select the mask in the
of the class which the object belongs to when the mask prediction
if not class-agnostic.</p></li>
<li><p><strong>reduction</strong> (<em>str</em><em>, </em><em>optional</em>) – The method used to reduce the loss.
Options are “none”, “mean” and “sum”.</p></li>
<li><p><strong>avg_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – Average factor that is used to average
the loss. Defaults to None.</p></li>
<li><p><strong>class_weight</strong> (<em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The weight for each class.</p></li>
<li><p><strong>ignore_index</strong> (<em>None</em>) – Placeholder, to be consistent with other loss.
Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.reduce_loss">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">reduce_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/utils.html#reduce_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.reduce_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce loss as specified.
:param loss: Elementwise loss tensor.
:type loss: Tensor
:param reduction: Options are “none”, “mean” and “sum”.
:type reduction: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Reduced loss tensor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.weight_reduce_loss">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">weight_reduce_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/utils.html#weight_reduce_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.weight_reduce_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply element-wise weight and reduce loss.
:param loss: Element-wise loss.
:type loss: Tensor
:param weight: Element-wise weights.
:type weight: Tensor
:param reduction: Same as built-in losses of PyTorch.
:type reduction: str
:param avg_factor: Avarage factor when computing the mean of losses.
:type avg_factor: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Processed loss values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmseg.models.losses.weighted_loss">
<span class="sig-prename descclassname"><span class="pre">mmseg.models.losses.</span></span><span class="sig-name descname"><span class="pre">weighted_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mmseg/models/losses/utils.html#weighted_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mmseg.models.losses.weighted_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a weighted version of a given loss function.
To use this decorator, the loss function must have the signature like
<cite>loss_func(pred, target, **kwargs)</cite>. The function only needs to compute
element-wise loss without any reduction. This decorator will add weight
and reduction arguments to the function. The decorated function will have
the signature like <cite>loss_func(pred, target, weight=None, reduction=’mean’,
avg_factor=None, **kwargs)</cite>.
:Example:
&gt;&gt;&gt; import torch
&gt;&gt;&gt; &#64;weighted_loss
&gt;&gt;&gt; def l1_loss(pred, target):
&gt;&gt;&gt;     return (pred - target).abs()
&gt;&gt;&gt; pred = torch.Tensor([0, 2, 3])
&gt;&gt;&gt; target = torch.Tensor([1, 1, 1])
&gt;&gt;&gt; weight = torch.Tensor([1, 0, 1])
&gt;&gt;&gt; l1_loss(pred, target)
tensor(1.3333)
&gt;&gt;&gt; l1_loss(pred, target, weight)
tensor(1.)
&gt;&gt;&gt; l1_loss(pred, target, reduction=’none’)
tensor([1., 1., 2.])
&gt;&gt;&gt; l1_loss(pred, target, weight, avg_factor=2)
tensor(1.5000)</p>
</dd></dl>

</section>
</section>


              </article>
              
            </div>
            <footer>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2022, EarthNets.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">mmseg.apis</a></li>
<li><a class="reference internal" href="#mmseg-core">mmseg.core</a><ul>
<li><a class="reference internal" href="#module-mmseg.core.seg">seg</a></li>
<li><a class="reference internal" href="#module-mmseg.core.evaluation">evaluation</a></li>
<li><a class="reference internal" href="#module-mmseg.core.utils">utils</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmseg-datasets">mmseg.datasets</a><ul>
<li><a class="reference internal" href="#module-mmseg.datasets">datasets</a></li>
<li><a class="reference internal" href="#module-mmseg.datasets.pipelines">pipelines</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmseg-models">mmseg.models</a><ul>
<li><a class="reference internal" href="#module-mmseg.models.segmentors">segmentors</a></li>
<li><a class="reference internal" href="#module-mmseg.models.backbones">backbones</a></li>
<li><a class="reference internal" href="#module-mmseg.models.decode_heads">decode_heads</a></li>
<li><a class="reference internal" href="#module-mmseg.models.losses">losses</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="./"
    src="_static/documentation_options.js"></script>
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
  <script src="_static/jquery.js"></script>
  <script src="_static/underscore.js"></script>
  <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
  <script src="_static/doctools.js"></script>
  <script src="_static/clipboard.min.js"></script>
  <script src="_static/copybutton.js"></script>
  

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://rsi-segmentation.readthedocs.io/en/latest/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/EarthNets/RSI-Segmentation/blob/main/demo/rsi_segmentation_tutorial.ipynb" target="_blank">Tutorial</a>
          </li>
          <li>
            <a href="https://github.com/EarthNets/RSI-Segmentation" target="_blank">GitHub</a>
          </li>
          <li class="resources-mobile-menu-title" >
            About
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://github.com/open-mmlab/mmcv" target="_blank">MMCV</a>
            </li>
          </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>